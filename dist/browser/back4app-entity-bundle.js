// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

/*!
 * chai
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

/*!
 * Chai version
 */

/*!
 * Assertion Error
 */

/*!
 * Utils for plugins (not exported)
 */

/*!
 * Utility Functions
 */

/*!
 * Configuration
 */

/*!
 * Primary `Assertion` prototype
 */

/*!
 * Core Assertions
 */

/*!
 * Expect interface
 */

/*!
 * Should interface
 */

/*!
 * Assert interface
 */

/*!
 * chai
 * http://chaijs.com
 * Copyright(c) 2011-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

/*!
   * Module dependencies.
   */

/*!
   * Module export.
   */

/*!
   * Assertion Constructor
   *
   * Creates object for chaining.
   *
   * @api private
   */

/*!
   * ### ._obj
   *
   * Quick reference to stored `actual` value for plugin developers.
   *
   * @api private
   */

/*!
   * Chai dependencies.
   */

/*!
   * ### .ifError(object)
   *
   * Asserts if value is not a false value, and throws if it is a true value.
   * This is added to allow for chai to be a drop-in replacement for Node's
   * assert class.
   *
   *     var err = new Error('I am a custom error');
   *     assert.ifError(err); // Rethrows err!
   *
   * @name ifError
   * @param {Object} object
   * @api public
   */

/*!
   * Aliases.
   */

/*!
 * Chai - addChainingMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

/*!
 * Module dependencies
 */

/*!
 * Module variables
 */

/*!
 * Chai - addMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

/*!
 * Chai - addProperty utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

/*!
 * Chai - expectTypes utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

/*!
 * Chai - flag utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

/*!
 * Chai - getActual utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

/*!
 * Chai - getEnumerableProperties utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

/*!
 * Chai - message composition utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

/*!
 * Module dependancies
 */

/*!
 * Chai - getName utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

/*!
 * Chai - getPathInfo utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

/*!
 * ## parsePath(path)
 *
 * Helper function used to parse string object
 * paths. Use in conjunction with `_getPathValue`.
 *
 *      var parsed = parsePath('myobject.property.subprop');
 *
 * ### Paths:
 *
 * * Can be as near infinitely deep and nested
 * * Arrays are also valid using the formal `myobject.document[3].property`.
 * * Literal dots and brackets (not delimiter) must be backslash-escaped.
 *
 * @param {String} path
 * @returns {Object} parsed
 * @api private
 */

/*!
 * ## _getPathValue(parsed, obj)
 *
 * Helper companion function for `.parsePath` that returns
 * the value located at the parsed address.
 *
 *      var value = getPathValue(parsed, obj);
 *
 * @param {Object} parsed definition from `parsePath`.
 * @param {Object} object to search against
 * @param {Number} object to search against
 * @returns {Object|Undefined} value
 * @api private
 */

/*!
 * Chai - getPathValue utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * @see https://github.com/logicalparadox/filtr
 * MIT Licensed
 */

/*!
 * Chai - getProperties utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

/*!
 * Chai - hasProperty utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

/*!
 * chai
 * Copyright(c) 2011 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

/*!
 * Main exports
 */

/*!
 * test utility
 */

/*!
 * type utility
 */

/*!
 * expectTypes utility
 */

/*!
 * message utility
 */

/*!
 * actual utility
 */

/*!
 * Inspect util
 */

/*!
 * Object Display util
 */

/*!
 * Flag utility
 */

/*!
 * Flag transferring utility
 */

/*!
 * Deep equal utility
 */

/*!
 * Deep path value
 */

/*!
 * Deep path info
 */

/*!
 * Check if a property exists
 */

/*!
 * Function name
 */

/*!
 * add Property
 */

/*!
 * add Method
 */

/*!
 * overwrite Property
 */

/*!
 * overwrite Method
 */

/*!
 * Add a chainable method
 */

/*!
 * Overwrite chainable method
 */

/*!
 * Chai - overwriteChainableMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

/*!
 * Chai - overwriteMethod utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

/*!
 * Chai - overwriteProperty utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

/*!
 * Chai - test utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

/*!
 * Chai - transferFlags utility
 * Copyright(c) 2012-2014 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

/*!
 * assertion-error
 * Copyright(c) 2013 Jake Luer <jake@qualiancy.com>
 * MIT Licensed
 */

/*!
 * Return a function that will copy properties from
 * one object to another excluding any originally
 * listed. Returned function will create a new `{}`.
 *
 * @param {String} excluded properties ...
 * @return {Function}
 */

/*!
 * Primary Exports
 */

/*!
 * Inherit from Error.prototype
 */

/*!
 * Statically set name
 */

/*!
 * Ensure correct constructor
 */

/*!
 * deep-eql
 * Copyright(c) 2013 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

/*!
 * Buffer.isBuffer browser shim
 */

/*!
 * Primary Export
 */

/*!
 * Strict (egal) equality test. Ensures that NaN always
 * equals NaN and `-0` does not equal `+0`.
 *
 * @param {Mixed} a
 * @param {Mixed} b
 * @return {Boolean} equal match
 */

/*!
 * Compare the types of two given objects and
 * return if they are equal. Note that an Array
 * has a type of `array` (not `object`) and arguments
 * have a type of `arguments` (not `array`/`object`).
 *
 * @param {Mixed} a
 * @param {Mixed} b
 * @return {Boolean} result
 */

/*!
 * Compare two Date objects by asserting that
 * the time values are equal using `saveValue`.
 *
 * @param {Date} a
 * @param {Date} b
 * @return {Boolean} result
 */

/*!
 * Compare two regular expressions by converting them
 * to string and checking for `sameValue`.
 *
 * @param {RegExp} a
 * @param {RegExp} b
 * @return {Boolean} result
 */

/*!
 * Assert deep equality of two `arguments` objects.
 * Unfortunately, these must be sliced to arrays
 * prior to test to ensure no bad behavior.
 *
 * @param {Arguments} a
 * @param {Arguments} b
 * @param {Array} memoize (optional)
 * @return {Boolean} result
 */

/*!
 * Get enumerable properties of a given object.
 *
 * @param {Object} a
 * @return {Array} property names
 */

/*!
 * Simple equality for flat iterable objects
 * such as Arrays or Node.js buffers.
 *
 * @param {Iterable} a
 * @param {Iterable} b
 * @return {Boolean} result
 */

/*!
 * Extension to `iterableEqual` specifically
 * for Node.js Buffers.
 *
 * @param {Buffer} a
 * @param {Mixed} b
 * @return {Boolean} result
 */

/*!
 * Block for `objectEqual` ensuring non-existing
 * values don't get in.
 *
 * @param {Mixed} object
 * @return {Boolean} result
 */

/*!
 * Recursively check the equality of two objects.
 * Once basic sameness has been established it will
 * defer to `deepEqual` for each enumerable key
 * in the object.
 *
 * @param {Mixed} a
 * @param {Mixed} b
 * @return {Boolean} result
 */

/*!
 * type-detect
 * Copyright(c) 2013 jake luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

/*!
 * Detectable javascript natives
 */

/* @preserve
 * The MIT License (MIT)
 * 
 * Copyright (c) 2013-2015 Petka Antonov
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 * 
 */

//     uuid.js
//
//     Copyright (c) 2010-2012 Robert Kieffer
//     MIT License - http://opensource.org/licenses/mit-license.php

!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("util",[],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.util=e()}}(function(){var e,t,n;return function r(e,t,n){function i(o,u){if(!t[o]){if(!e[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(s)return s(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=t[o]={exports:{}};e[o][0].call(l.exports,function(t){var n=e[o][1][t];return i(n?n:t)},l,l.exports,r,e,t,n)}return t[o].exports}var s=typeof require=="function"&&require;for(var o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,n){typeof Object.create=="function"?t.exports=function(t,n){t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,n){t.super_=n;var r=function(){};r.prototype=n.prototype,t.prototype=new r,t.prototype.constructor=t}},{}],2:[function(e,t,n){function i(){}var r=t.exports={};r.nextTick=function(){var e=typeof window!="undefined"&&window.setImmediate,t=typeof window!="undefined"&&window.MutationObserver,n=typeof window!="undefined"&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};var r=[];if(t){var i=document.createElement("div"),s=new MutationObserver(function(){var e=r.slice();r.length=0,e.forEach(function(e){e()})});return s.observe(i,{attributes:!0}),function(t){r.length||i.setAttribute("yes","no"),r.push(t)}}return n?(window.addEventListener("message",function(e){var t=e.source;if((t===window||t===null)&&e.data==="process-tick"){e.stopPropagation();if(r.length>0){var n=r.shift();n()}}},!0),function(t){r.push(t),window.postMessage("process-tick","*")}):function(t){setTimeout(t,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=i,r.addListener=i,r.once=i,r.off=i,r.removeListener=i,r.removeAllListeners=i,r.emit=i,r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],3:[function(e,t,n){t.exports=function(t){return t&&typeof t=="object"&&typeof t.copy=="function"&&typeof t.fill=="function"&&typeof t.readUInt8=="function"}},{}],4:[function(e,t,n){(function(t,r){function u(e,t){var r={seen:[],stylize:f};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),y(t)?r.showHidden=t:t&&n._extend(r,t),T(r.showHidden)&&(r.showHidden=!1),T(r.depth)&&(r.depth=2),T(r.colors)&&(r.colors=!1),T(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=a),c(r,e,r.depth)}function a(e,t){var n=u.styles[t];return n?"["+u.colors[n][0]+"m"+e+"["+u.colors[n][1]+"m":e}function f(e,t){return e}function l(e){var t={};return e.forEach(function(e,n){t[e]=!0}),t}function c(e,t,r){if(e.customInspect&&t&&A(t.inspect)&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var i=t.inspect(r,e);return S(i)||(i=c(e,i,r)),i}var s=h(e,t);if(s)return s;var o=Object.keys(t),u=l(o);e.showHidden&&(o=Object.getOwnPropertyNames(t));if(L(t)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return p(t);if(o.length===0){if(A(t)){var a=t.name?": "+t.name:"";return e.stylize("[Function"+a+"]","special")}if(N(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(k(t))return e.stylize(Date.prototype.toString.call(t),"date");if(L(t))return p(t)}var f="",y=!1,b=["{","}"];g(t)&&(y=!0,b=["[","]"]);if(A(t)){var w=t.name?": "+t.name:"";f=" [Function"+w+"]"}N(t)&&(f=" "+RegExp.prototype.toString.call(t)),k(t)&&(f=" "+Date.prototype.toUTCString.call(t)),L(t)&&(f=" "+p(t));if(o.length!==0||!!y&&t.length!=0){if(r<0)return N(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var E;return y?E=d(e,t,r,u,o):E=o.map(function(n){return v(e,t,r,u,n,y)}),e.seen.pop(),m(E,f,b)}return b[0]+f+b[1]}function h(e,t){if(T(t))return e.stylize("undefined","undefined");if(S(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(E(t))return e.stylize(""+t,"number");if(y(t))return e.stylize(""+t,"boolean");if(b(t))return e.stylize("null","null")}function p(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,n,r,i){var s=[];for(var o=0,u=t.length;o<u;++o)H(t,String(o))?s.push(v(e,t,n,r,String(o),!0)):s.push("");return i.forEach(function(i){i.match(/^\d+$/)||s.push(v(e,t,n,r,i,!0))}),s}function v(e,t,n,r,i,s){var o,u,a;a=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]},a.get?a.set?u=e.stylize("[Getter/Setter]","special"):u=e.stylize("[Getter]","special"):a.set&&(u=e.stylize("[Setter]","special")),H(r,i)||(o="["+i+"]"),u||(e.seen.indexOf(a.value)<0?(b(n)?u=c(e,a.value,null):u=c(e,a.value,n-1),u.indexOf("\n")>-1&&(s?u=u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):u="\n"+u.split("\n").map(function(e){return"   "+e}).join("\n"))):u=e.stylize("[Circular]","special"));if(T(o)){if(s&&i.match(/^\d+$/))return u;o=JSON.stringify(""+i),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+u}function m(e,t,n){var r=0,i=e.reduce(function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(t===""?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function g(e){return Array.isArray(e)}function y(e){return typeof e=="boolean"}function b(e){return e===null}function w(e){return e==null}function E(e){return typeof e=="number"}function S(e){return typeof e=="string"}function x(e){return typeof e=="symbol"}function T(e){return e===void 0}function N(e){return C(e)&&M(e)==="[object RegExp]"}function C(e){return typeof e=="object"&&e!==null}function k(e){return C(e)&&M(e)==="[object Date]"}function L(e){return C(e)&&(M(e)==="[object Error]"||e instanceof Error)}function A(e){return typeof e=="function"}function O(e){return e===null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||typeof e=="symbol"||typeof e=="undefined"}function M(e){return Object.prototype.toString.call(e)}function _(e){return e<10?"0"+e.toString(10):e.toString(10)}function P(){var e=new Date,t=[_(e.getHours()),_(e.getMinutes()),_(e.getSeconds())].join(":");return[e.getDate(),D[e.getMonth()],t].join(" ")}function H(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var i=/%[sdj%]/g;n.format=function(e){if(!S(e)){var t=[];for(var n=0;n<arguments.length;n++)t.push(u(arguments[n]));return t.join(" ")}var n=1,r=arguments,s=r.length,o=String(e).replace(i,function(e){if(e==="%%")return"%";if(n>=s)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"};default:return e}});for(var a=r[n];n<s;a=r[++n])b(a)||!C(a)?o+=" "+a:o+=" "+u(a);return o},n.deprecate=function(e,i){function o(){if(!s){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),s=!0}return e.apply(this,arguments)}if(T(r.process))return function(){return n.deprecate(e,i).apply(this,arguments)};if(t.noDeprecation===!0)return e;var s=!1;return o};var s={},o;n.debuglog=function(e){T(o)&&(o=t.env.NODE_DEBUG||""),e=e.toUpperCase();if(!s[e])if((new RegExp("\\b"+e+"\\b","i")).test(o)){var r=t.pid;s[e]=function(){var t=n.format.apply(n,arguments);console.error("%s %d: %s",e,r,t)}}else s[e]=function(){};return s[e]},n.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow","boolean":"yellow","undefined":"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=g,n.isBoolean=y,n.isNull=b,n.isNullOrUndefined=w,n.isNumber=E,n.isString=S,n.isSymbol=x,n.isUndefined=T,n.isRegExp=N,n.isObject=C,n.isDate=k,n.isError=L,n.isFunction=A,n.isPrimitive=O,n.isBuffer=e("./support/isBuffer");var D=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",P(),n.format.apply(n,arguments))},n.inherits=e("inherits"),n._extend=function(e,t){if(!t||!C(t))return e;var n=Object.keys(t),r=n.length;while(r--)e[n[r]]=t[n[r]];return e}}).call(this,e("_process"),typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"./support/isBuffer":3,_process:2,inherits:1}],5:[function(e,t,n){t.exports=e("util")},{util:4}]},{},[5])(5)}),function(e){if(typeof exports=="object"&&typeof module!="undefined")module.exports=e();else if(typeof define=="function"&&define.amd)define("chai",[],e);else{var t;typeof window!="undefined"?t=window:typeof global!="undefined"?t=global:typeof self!="undefined"?t=self:t=this,t.chai=e()}}(function(){var e,t,n;return function r(e,t,n){function i(o,u){if(!t[o]){if(!e[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(s)return s(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=t[o]={exports:{}};e[o][0].call(l.exports,function(t){var n=e[o][1][t];return i(n?n:t)},l,l.exports,r,e,t,n)}return t[o].exports}var s=typeof require=="function"&&require;for(var o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,n){t.exports=e("./lib/chai")},{"./lib/chai":2}],2:[function(e,t,n){var r=[],n=t.exports={};n.version="3.4.0",n.AssertionError=e("assertion-error");var i=e("./chai/utils");n.use=function(e){return~r.indexOf(e)||(e(this,i),r.push(e)),this},n.util=i;var s=e("./chai/config");n.config=s;var o=e("./chai/assertion");n.use(o);var u=e("./chai/core/assertions");n.use(u);var a=e("./chai/interface/expect");n.use(a);var f=e("./chai/interface/should");n.use(f);var l=e("./chai/interface/assert");n.use(l)},{"./chai/assertion":3,"./chai/config":4,"./chai/core/assertions":5,"./chai/interface/assert":6,"./chai/interface/expect":7,"./chai/interface/should":8,"./chai/utils":22,"assertion-error":30}],3:[function(e,t,n){var r=e("./config");t.exports=function(e,t){function s(e,t,n){i(this,"ssfi",n||arguments.callee),i(this,"object",e),i(this,"message",t)}var n=e.AssertionError,i=t.flag;e.Assertion=s,Object.defineProperty(s,"includeStack",{get:function(){return console.warn("Assertion.includeStack is deprecated, use chai.config.includeStack instead."),r.includeStack},set:function(e){console.warn("Assertion.includeStack is deprecated, use chai.config.includeStack instead."),r.includeStack=e}}),Object.defineProperty(s,"showDiff",{get:function(){return console.warn("Assertion.showDiff is deprecated, use chai.config.showDiff instead."),r.showDiff},set:function(e){console.warn("Assertion.showDiff is deprecated, use chai.config.showDiff instead."),r.showDiff=e}}),s.addProperty=function(e,n){t.addProperty(this.prototype,e,n)},s.addMethod=function(e,n){t.addMethod(this.prototype,e,n)},s.addChainableMethod=function(e,n,r){t.addChainableMethod(this.prototype,e,n,r)},s.overwriteProperty=function(e,n){t.overwriteProperty(this.prototype,e,n)},s.overwriteMethod=function(e,n){t.overwriteMethod(this.prototype,e,n)},s.overwriteChainableMethod=function(e,n,r){t.overwriteChainableMethod(this.prototype,e,n,r)},s.prototype.assert=function(e,s,o,u,a,f){var l=t.test(this,arguments);!0!==f&&(f=!1),!0!==r.showDiff&&(f=!1);if(!l){var s=t.getMessage(this,arguments),c=t.getActual(this,arguments);throw new n(s,{actual:c,expected:u,showDiff:f},r.includeStack?this.assert:i(this,"ssfi"))}},Object.defineProperty(s.prototype,"_obj",{get:function(){return i(this,"object")},set:function(e){i(this,"object",e)}})}},{"./config":4}],4:[function(e,t,n){t.exports={includeStack:!1,showDiff:!0,truncateThreshold:40}},{}],5:[function(e,t,n){t.exports=function(e,t){function s(e,n){n&&i(this,"message",n),e=e.toLowerCase();var r=i(this,"object"),s=~["a","e","i","o","u"].indexOf(e.charAt(0))?"an ":"a ";this.assert(e===t.type(r),"expected #{this} to be "+s+e,"expected #{this} not to be "+s+e)}function o(){i(this,"contains",!0)}function u(e,r){t.expectTypes(this,["array","object","string"]),r&&i(this,"message",r);var s=i(this,"object"),o=!1;if(t.type(s)==="array"&&t.type(e)==="object"){for(var u in s)if(t.eql(s[u],e)){o=!0;break}}else if(t.type(e)==="object"){if(!i(this,"negate")){for(var a in e)(new n(s)).property(a,e[a]);return}var f={};for(var a in e)f[a]=s[a];o=t.eql(f,e)}else o=s!=undefined&&~s.indexOf(e);this.assert(o,"expected #{this} to include "+t.inspect(e),"expected #{this} to not include "+t.inspect(e))}function a(){var e=i(this,"object"),t=Object.prototype.toString.call(e);this.assert("[object Arguments]"===t,"expected #{this} to be arguments but got "+t,"expected #{this} to not be arguments")}function f(e,t){t&&i(this,"message",t);var n=i(this,"object");if(i(this,"deep"))return this.eql(e);this.assert(e===n,"expected #{this} to equal #{exp}","expected #{this} to not equal #{exp}",e,this._obj,!0)}function l(e,n){n&&i(this,"message",n),this.assert(t.eql(e,i(this,"object")),"expected #{this} to deeply equal #{exp}","expected #{this} to not deeply equal #{exp}",e,this._obj,!0)}function c(e,t){t&&i(this,"message",t);var r=i(this,"object");if(i(this,"doLength")){(new n(r,t)).to.have.property("length");var s=r.length;this.assert(s>e,"expected #{this} to have a length above #{exp} but got #{act}","expected #{this} to not have a length above #{exp}",e,s)}else this.assert(r>e,"expected #{this} to be above "+e,"expected #{this} to be at most "+e)}function h(e,t){t&&i(this,"message",t);var r=i(this,"object");if(i(this,"doLength")){(new n(r,t)).to.have.property("length");var s=r.length;this.assert(s>=e,"expected #{this} to have a length at least #{exp} but got #{act}","expected #{this} to have a length below #{exp}",e,s)}else this.assert(r>=e,"expected #{this} to be at least "+e,"expected #{this} to be below "+e)}function p(e,t){t&&i(this,"message",t);var r=i(this,"object");if(i(this,"doLength")){(new n(r,t)).to.have.property("length");var s=r.length;this.assert(s<e,"expected #{this} to have a length below #{exp} but got #{act}","expected #{this} to not have a length below #{exp}",e,s)}else this.assert(r<e,"expected #{this} to be below "+e,"expected #{this} to be at least "+e)}function d(e,t){t&&i(this,"message",t);var r=i(this,"object");if(i(this,"doLength")){(new n(r,t)).to.have.property("length");var s=r.length;this.assert(s<=e,"expected #{this} to have a length at most #{exp} but got #{act}","expected #{this} to have a length above #{exp}",e,s)}else this.assert(r<=e,"expected #{this} to be at most "+e,"expected #{this} to be above "+e)}function v(e,n){n&&i(this,"message",n);var r=t.getName(e);this.assert(i(this,"object")instanceof e,"expected #{this} to be an instance of "+r,"expected #{this} to not be an instance of "+r)}function m(e,n){n&&i(this,"message",n);var r=i(this,"object");this.assert(r.hasOwnProperty(e),"expected #{this} to have own property "+t.inspect(e),"expected #{this} to not have own property "+t.inspect(e))}function g(e,n,r){typeof n=="string"&&(r=n,n=null),r&&i(this,"message",r);var s=i(this,"object"),o=Object.getOwnPropertyDescriptor(Object(s),e);o&&n?this.assert(t.eql(n,o),"expected the own property descriptor for "+t.inspect(e)+" on #{this} to match "+t.inspect(n)+", got "+t.inspect(o),"expected the own property descriptor for "+t.inspect(e)+" on #{this} to not match "+t.inspect(n),n,o,!0):this.assert(o,"expected #{this} to have an own property descriptor for "+t.inspect(e),"expected #{this} to not have an own property descriptor for "+t.inspect(e)),i(this,"object",o)}function y(){i(this,"doLength",!0)}function b(e,t){t&&i(this,"message",t);var r=i(this,"object");(new n(r,t)).to.have.property("length");var s=r.length;this.assert(s==e,"expected #{this} to have a length of #{exp} but got #{act}","expected #{this} to not have a length of #{act}",e,s)}function w(e,t){t&&i(this,"message",t);var n=i(this,"object");this.assert(e.exec(n),"expected #{this} to match "+e,"expected #{this} not to match "+e)}function E(e){var n=i(this,"object"),r,s=!0,o="keys must be given single argument of Array|Object|String, or multiple String arguments";switch(t.type(e)){case"array":if(arguments.length>1)throw new Error(o);break;case"object":if(arguments.length>1)throw new Error(o);e=Object.keys(e);break;default:e=Array.prototype.slice.call(arguments)}if(!e.length)throw new Error("keys required");var u=Object.keys(n),a=e,f=e.length,l=i(this,"any"),c=i(this,"all");!l&&!c&&(c=!0);if(l){var h=a.filter(function(e){return~u.indexOf(e)});s=h.length>0}c&&(s=e.every(function(e){return~u.indexOf(e)}),!i(this,"negate")&&!i(this,"contains")&&(s=s&&e.length==u.length));if(f>1){e=e.map(function(e){return t.inspect(e)});var p=e.pop();c&&(r=e.join(", ")+", and "+p),l&&(r=e.join(", ")+", or "+p)}else r=t.inspect(e[0]);r=(f>1?"keys ":"key ")+r,r=(i(this,"contains")?"contain ":"have ")+r,this.assert(s,"expected #{this} to "+r,"expected #{this} to not "+r,a.slice(0).sort(),u.sort(),!0)}function S(e,r,s){s&&i(this,"message",s);var o=i(this,"object");(new n(o,s)).is.a("function");var u=!1,a=null,f=null,l=null;if(arguments.length===0)r=null,e=null;else if(e&&(e instanceof RegExp||"string"==typeof e))r=e,e=null;else if(e&&e instanceof Error)a=e,e=null,r=null;else if(typeof e=="function"){f=e.prototype.name;if(!f||f==="Error"&&e!==Error)f=e.name||(new e).name}else e=null;try{o()}catch(c){if(a)return this.assert(c===a,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp}",a instanceof Error?a.toString():a,c instanceof Error?c.toString():c),i(this,"object",c),this;if(e){this.assert(c instanceof e,"expected #{this} to throw #{exp} but #{act} was thrown","expected #{this} to not throw #{exp} but #{act} was thrown",f,c instanceof Error?c.toString():c);if(!r)return i(this,"object",c),this}var h="error"===t.type(c)&&"message"in c?c.message:""+c;if(h!=null&&r&&r instanceof RegExp)return this.assert(r.exec(h),"expected #{this} to throw error matching #{exp} but got #{act}","expected #{this} to throw error not matching #{exp}",r,h),i(this,"object",c),this;if(h!=null&&r&&"string"==typeof r)return this.assert(~h.indexOf(r),"expected #{this} to throw error including #{exp} but got #{act}","expected #{this} to throw error not including #{act}",r,h),i(this,"object",c),this;u=!0,l=c}var p="",d=f!==null?f:a?"#{exp}":"an error";u&&(p=" but #{act} was thrown"),this.assert(u===!0,"expected #{this} to throw "+d+p,"expected #{this} to not throw "+d+p,a instanceof Error?a.toString():a,l instanceof Error?l.toString():l),i(this,"object",l)}function x(e,n){n&&i(this,"message",n);var r=i(this,"object"),s=i(this,"itself"),o="function"===t.type(r)&&!s?r.prototype[e]:r[e];this.assert("function"==typeof o,"expected #{this} to respond to "+t.inspect(e),"expected #{this} to not respond to "+t.inspect(e))}function T(e,n){n&&i(this,"message",n);var r=i(this,"object"),s=e(r);this.assert(s,"expected #{this} to satisfy "+t.objDisplay(e),"expected #{this} to not satisfy"+t.objDisplay(e),this.negate?!1:!0,s)}function N(e,r,s){s&&i(this,"message",s);var o=i(this,"object");(new n(o,s)).is.a("number");if(t.type(e)!=="number"||t.type(r)!=="number")throw new Error("the arguments to closeTo or approximately must be numbers");this.assert(Math.abs(o-e)<=r,"expected #{this} to be close to "+e+" +/- "+r,"expected #{this} not to be close to "+e+" +/- "+r)}function C(e,t,n){return e.every(function(e){return n?t.some(function(t){return n(e,t)}):t.indexOf(e)!==-1})}function k(e,t){t&&i(this,"message",t);var r=i(this,"object");(new n(e)).to.be.an("array"),this.assert(e.indexOf(r)>-1,"expected #{this} to be one of #{exp}","expected #{this} to not be one of #{exp}",e,r)}function L(e,t,r){r&&i(this,"message",r);var s=i(this,"object");(new n(e,r)).to.have.property(t),(new n(s)).is.a("function");var o=e[t];s(),this.assert(o!==e[t],"expected ."+t+" to change","expected ."+t+" to not change")}function A(e,t,r){r&&i(this,"message",r);var s=i(this,"object");(new n(e,r)).to.have.property(t),(new n(s)).is.a("function");var o=e[t];s(),this.assert(e[t]-o>0,"expected ."+t+" to increase","expected ."+t+" to not increase")}function O(e,t,r){r&&i(this,"message",r);var s=i(this,"object");(new n(e,r)).to.have.property(t),(new n(s)).is.a("function");var o=e[t];s(),this.assert(e[t]-o<0,"expected ."+t+" to decrease","expected ."+t+" to not decrease")}var n=e.Assertion,r=Object.prototype.toString,i=t.flag;["to","be","been","is","and","has","have","with","that","which","at","of","same"].forEach(function(e){n.addProperty(e,function(){return this})}),n.addProperty("not",function(){i(this,"negate",!0)}),n.addProperty("deep",function(){i(this,"deep",!0)}),n.addProperty("any",function(){i(this,"any",!0),i(this,"all",!1)}),n.addProperty("all",function(){i(this,"all",!0),i(this,"any",!1)}),n.addChainableMethod("an",s),n.addChainableMethod("a",s),n.addChainableMethod("include",u,o),n.addChainableMethod("contain",u,o),n.addChainableMethod("contains",u,o),n.addChainableMethod("includes",u,o),n.addProperty("ok",function(){this.assert(i(this,"object"),"expected #{this} to be truthy","expected #{this} to be falsy")}),n.addProperty("true",function(){this.assert(!0===i(this,"object"),"expected #{this} to be true","expected #{this} to be false",this.negate?!1:!0)}),n.addProperty("false",function(){this.assert(!1===i(this,"object"),"expected #{this} to be false","expected #{this} to be true",this.negate?!0:!1)}),n.addProperty("null",function(){this.assert(null===i(this,"object"),"expected #{this} to be null","expected #{this} not to be null")}),n.addProperty("undefined",function(){this.assert(undefined===i(this,"object"),"expected #{this} to be undefined","expected #{this} not to be undefined")}),n.addProperty("NaN",function(){this.assert(isNaN(i(this,"object")),"expected #{this} to be NaN","expected #{this} not to be NaN")}),n.addProperty("exist",function(){this.assert(null!=i(this,"object"),"expected #{this} to exist","expected #{this} to not exist")}),n.addProperty("empty",function(){var e=i(this,"object"),t=e;Array.isArray(e)||"string"==typeof object?t=e.length:typeof e=="object"&&(t=Object.keys(e).length),this.assert(!t,"expected #{this} to be empty","expected #{this} not to be empty")}),n.addProperty("arguments",a),n.addProperty("Arguments",a),n.addMethod("equal",f),n.addMethod("equals",f),n.addMethod("eq",f),n.addMethod("eql",l),n.addMethod("eqls",l),n.addMethod("above",c),n.addMethod("gt",c),n.addMethod("greaterThan",c),n.addMethod("least",h),n.addMethod("gte",h),n.addMethod("below",p),n.addMethod("lt",p),n.addMethod("lessThan",p),n.addMethod("most",d),n.addMethod("lte",d),n.addMethod("within",function(e,t,r){r&&i(this,"message",r);var s=i(this,"object"),o=e+".."+t;if(i(this,"doLength")){(new n(s,r)).to.have.property("length");var u=s.length;this.assert(u>=e&&u<=t,"expected #{this} to have a length within "+o,"expected #{this} to not have a length within "+o)}else this.assert(s>=e&&s<=t,"expected #{this} to be within "+o,"expected #{this} to not be within "+o)}),n.addMethod("instanceof",v),n.addMethod("instanceOf",v),n.addMethod("property",function(e,n,r){r&&i(this,"message",r);var s=!!i(this,"deep"),o=s?"deep property ":"property ",u=i(this,"negate"),a=i(this,"object"),f=s?t.getPathInfo(e,a):null,l=s?f.exists:t.hasProperty(e,a),c=s?f.value:a[e];if(u&&arguments.length>1){if(undefined===c)throw r=r!=null?r+": ":"",new Error(r+t.inspect(a)+" has no "+o+t.inspect(e))}else this.assert(l,"expected #{this} to have a "+o+t.inspect(e),"expected #{this} to not have "+o+t.inspect(e));arguments.length>1&&this.assert(n===c,"expected #{this} to have a "+o+t.inspect(e)+" of #{exp}, but got #{act}","expected #{this} to not have a "+o+t.inspect(e)+" of #{act}",n,c),i(this,"object",c)}),n.addMethod("ownProperty",m),n.addMethod("haveOwnProperty",m),n.addMethod("ownPropertyDescriptor",g),n.addMethod("haveOwnPropertyDescriptor",g),n.addChainableMethod("length",b,y),n.addMethod("lengthOf",b),n.addMethod("match",w),n.addMethod("matches",w),n.addMethod("string",function(e,r){r&&i(this,"message",r);var s=i(this,"object");(new n(s,r)).is.a("string"),this.assert(~s.indexOf(e),"expected #{this} to contain "+t.inspect(e),"expected #{this} to not contain "+t.inspect(e))}),n.addMethod("keys",E),n.addMethod("key",E),n.addMethod("throw",S),n.addMethod("throws",S),n.addMethod("Throw",S),n.addMethod("respondTo",x),n.addMethod("respondsTo",x),n.addProperty("itself",function(){i(this,"itself",!0)}),n.addMethod("satisfy",T),n.addMethod("satisfies",T),n.addMethod("closeTo",N),n.addMethod("approximately",N),n.addMethod("members",function(e,r){r&&i(this,"message",r);var s=i(this,"object");(new n(s)).to.be.an("array"),(new n(e)).to.be.an("array");var o=i(this,"deep")?t.eql:undefined;if(i(this,"contains"))return this.assert(C(e,s,o),"expected #{this} to be a superset of #{act}","expected #{this} to not be a superset of #{act}",s,e);this.assert(C(s,e,o)&&C(e,s,o),"expected #{this} to have the same members as #{act}","expected #{this} to not have the same members as #{act}",s,e)}),n.addMethod("oneOf",k),n.addChainableMethod("change",L),n.addChainableMethod("changes",L),n.addChainableMethod("increase",A),n.addChainableMethod("increases",A),n.addChainableMethod("decrease",O),n.addChainableMethod("decreases",O),n.addProperty("extensible",function(){var e=i(this,"object"),t;try{t=Object.isExtensible(e)}catch(n){if(!(n instanceof TypeError))throw n;t=!1}this.assert(t,"expected #{this} to be extensible","expected #{this} to not be extensible")}),n.addProperty("sealed",function(){var e=i(this,"object"),t;try{t=Object.isSealed(e)}catch(n){if(!(n instanceof TypeError))throw n;t=!0}this.assert(t,"expected #{this} to be sealed","expected #{this} to not be sealed")}),n.addProperty("frozen",function(){var e=i(this,"object"),t;try{t=Object.isFrozen(e)}catch(n){if(!(n instanceof TypeError))throw n;t=!0}this.assert(t,"expected #{this} to be frozen","expected #{this} to not be frozen")})}},{}],6:[function(e,t,n){t.exports=function(e,t){var n=e.Assertion,r=t.flag,i=e.assert=function(t,r){var i=new n(null,null,e.assert);i.assert(t,r,"[ negation message unavailable ]")};i.fail=function(t,n,r,s){throw r=r||"assert.fail()",new e.AssertionError(r,{actual:t,expected:n,operator:s},i.fail)},i.isOk=function(e,t){(new n(e,t)).is.ok},i.isNotOk=function(e,t){(new n(e,t)).is.not.ok},i.equal=function(e,t,s){var o=new n(e,s,i.equal);o.assert(t==r(o,"object"),"expected #{this} to equal #{exp}","expected #{this} to not equal #{act}",t,e)},i.notEqual=function(e,t,s){var o=new n(e,s,i.notEqual);o.assert(t!=r(o,"object"),"expected #{this} to not equal #{exp}","expected #{this} to equal #{act}",t,e)},i.strictEqual=function(e,t,r){(new n(e,r)).to.equal(t)},i.notStrictEqual=function(e,t,r){(new n(e,r)).to.not.equal(t)},i.deepEqual=function(e,t,r){(new n(e,r)).to.eql(t)},i.notDeepEqual=function(e,t,r){(new n(e,r)).to.not.eql(t)},i.isAbove=function(e,t,r){(new n(e,r)).to.be.above(t)},i.isAtLeast=function(e,t,r){(new n(e,r)).to.be.least(t)},i.isBelow=function(e,t,r){(new n(e,r)).to.be.below(t)},i.isAtMost=function(e,t,r){(new n(e,r)).to.be.most(t)},i.isTrue=function(e,t){(new n(e,t)).is["true"]},i.isNotTrue=function(e,t){(new n(e,t)).to.not.equal(!0)},i.isFalse=function(e,t){(new n(e,t)).is["false"]},i.isNotFalse=function(e,t){(new n(e,t)).to.not.equal(!1)},i.isNull=function(e,t){(new n(e,t)).to.equal(null)},i.isNotNull=function(e,t){(new n(e,t)).to.not.equal(null)},i.isNaN=function(e,t){(new n(e,t)).to.be.NaN},i.isNotNaN=function(e,t){(new n(e,t)).not.to.be.NaN},i.isUndefined=function(e,t){(new n(e,t)).to.equal(undefined)},i.isDefined=function(e,t){(new n(e,t)).to.not.equal(undefined)},i.isFunction=function(e,t){(new n(e,t)).to.be.a("function")},i.isNotFunction=function(e,t){(new n(e,t)).to.not.be.a("function")},i.isObject=function(e,t){(new n(e,t)).to.be.a("object")},i.isNotObject=function(e,t){(new n(e,t)).to.not.be.a("object")},i.isArray=function(e,t){(new n(e,t)).to.be.an("array")},i.isNotArray=function(e,t){(new n(e,t)).to.not.be.an("array")},i.isString=function(e,t){(new n(e,t)).to.be.a("string")},i.isNotString=function(e,t){(new n(e,t)).to.not.be.a("string")},i.isNumber=function(e,t){(new n(e,t)).to.be.a("number")},i.isNotNumber=function(e,t){(new n(e,t)).to.not.be.a("number")},i.isBoolean=function(e,t){(new n(e,t)).to.be.a("boolean")},i.isNotBoolean=function(e,t){(new n(e,t)).to.not.be.a("boolean")},i.typeOf=function(e,t,r){(new n(e,r)).to.be.a(t)},i.notTypeOf=function(e,t,r){(new n(e,r)).to.not.be.a(t)},i.instanceOf=function(e,t,r){(new n(e,r)).to.be.instanceOf(t)},i.notInstanceOf=function(e,t,r){(new n(e,r)).to.not.be.instanceOf(t)},i.include=function(e,t,r){(new n(e,r,i.include)).include(t)},i.notInclude=function(e,t,r){(new n(e,r,i.notInclude)).not.include(t)},i.match=function(e,t,r){(new n(e,r)).to.match(t)},i.notMatch=function(e,t,r){(new n(e,r)).to.not.match(t)},i.property=function(e,t,r){(new n(e,r)).to.have.property(t)},i.notProperty=function(e,t,r){(new n(e,r)).to.not.have.property(t)},i.deepProperty=function(e,t,r){(new n(e,r)).to.have.deep.property(t)},i.notDeepProperty=function(e,t,r){(new n(e,r)).to.not.have.deep.property(t)},i.propertyVal=function(e,t,r,i){(new n(e,i)).to.have.property(t,r)},i.propertyNotVal=function(e,t,r,i){(new n(e,i)).to.not.have.property(t,r)},i.deepPropertyVal=function(e,t,r,i){(new n(e,i)).to.have.deep.property(t,r)},i.deepPropertyNotVal=function(e,t,r,i){(new n(e,i)).to.not.have.deep.property(t,r)},i.lengthOf=function(e,t,r){(new n(e,r)).to.have.length(t)},i.throws=function(e,t,i,s){if("string"==typeof t||t instanceof RegExp)i=t,t=null;var o=(new n(e,s)).to.throw(t,i);return r(o,"object")},i.doesNotThrow=function(e,t,r){"string"==typeof t&&(r=t,t=null),(new n(e,r)).to.not.Throw(t)},i.operator=function(e,i,s,o){var u;switch(i){case"==":u=e==s;break;case"===":u=e===s;break;case">":u=e>s;break;case">=":u=e>=s;break;case"<":u=e<s;break;case"<=":u=e<=s;break;case"!=":u=e!=s;break;case"!==":u=e!==s;break;default:throw new Error('Invalid operator "'+i+'"')}var a=new n(u,o);a.assert(!0===r(a,"object"),"expected "+t.inspect(e)+" to be "+i+" "+t.inspect(s),"expected "+t.inspect(e)+" to not be "+i+" "+t.inspect(s))},i.closeTo=function(e,t,r,i){(new n(e,i)).to.be.closeTo(t,r)},i.approximately=function(e,t,r,i){(new n(e,i)).to.be.approximately(t,r)},i.sameMembers=function(e,t,r){(new n(e,r)).to.have.same.members(t)},i.sameDeepMembers=function(e,t,r){(new n(e,r)).to.have.same.deep.members(t)},i.includeMembers=function(e,t,r){(new n(e,r)).to.include.members(t)},i.oneOf=function(e,t,r){(new n(e,r)).to.be.oneOf(t)},i.changes=function(e,t,r){(new n(e)).to.change(t,r)},i.doesNotChange=function(e,t,r){(new n(e)).to.not.change(t,r)},i.increases=function(e,t,r){(new n(e)).to.increase(t,r)},i.doesNotIncrease=function(e,t,r){(new n(e)).to.not.increase(t,r)},i.decreases=function(e,t,r){(new n(e)).to.decrease(t,r)},i.doesNotDecrease=function(e,t,r){(new n(e)).to.not.decrease(t,r)},i.ifError=function(e){if(e)throw e},i.isExtensible=function(e,t){(new n(e,t)).to.be.extensible},i.isNotExtensible=function(e,t){(new n(e,t)).to.not.be.extensible},i.isSealed=function(e,t){(new n(e,t)).to.be.sealed},i.isNotSealed=function(e,t){(new n(e,t)).to.not.be.sealed},i.isFrozen=function(e,t){(new n(e,t)).to.be.frozen},i.isNotFrozen=function(e,t){(new n(e,t)).to.not.be.frozen},function s(e,t){return i[t]=i[e],s}("isOk","ok")("isNotOk","notOk")("throws","throw")("throws","Throw")("isExtensible","extensible")("isNotExtensible","notExtensible")("isSealed","sealed")("isNotSealed","notSealed")("isFrozen","frozen")("isNotFrozen","notFrozen")}},{}],7:[function(e,t,n){t.exports=function(e,t){e.expect=function(t,n){return new e.Assertion(t,n)},e.expect.fail=function(t,n,r,i){throw r=r||"expect.fail()",new e.AssertionError(r,{actual:t,expected:n,operator:i},e.expect.fail)}}},{}],8:[function(e,t,n){t.exports=function(e,t){function r(){function t(){return this instanceof String||this instanceof Number||this instanceof Boolean?new n(this.valueOf(),null,t):new n(this,null,t)}function r(e){Object.defineProperty(this,"should",{value:e,enumerable:!0,configurable:!0,writable:!0})}Object.defineProperty(Object.prototype,"should",{set:r,get:t,configurable:!0});var i={};return i.fail=function(t,n,r,s){throw r=r||"should.fail()",new e.AssertionError(r,{actual:t,expected:n,operator:s},i.fail)},i.equal=function(e,t,r){(new n(e,r)).to.equal(t)},i.Throw=function(e,t,r,i){(new n(e,i)).to.Throw(t,r)},i.exist=function(e,t){(new n(e,t)).to.exist},i.not={},i.not.equal=function(e,t,r){(new n(e,r)).to.not.equal(t)},i.not.Throw=function(e,t,r,i){(new n(e,i)).to.not.Throw(t,r)},i.not.exist=function(e,t){(new n(e,t)).to.not.exist},i["throw"]=i.Throw,i.not["throw"]=i.not.Throw,i}var n=e.Assertion;e.should=r,e.Should=r}},{}],9:[function(e,t,n){var r=e("./transferFlags"),i=e("./flag"),s=e("../config"),o="__proto__"in Object,u=/^(?:length|name|arguments|caller)$/,a=Function.prototype.call,f=Function.prototype.apply;t.exports=function(e,t,n,l){typeof l!="function"&&(l=function(){});var c={method:n,chainingBehavior:l};e.__methods||(e.__methods={}),e.__methods[t]=c,Object.defineProperty(e,t,{get:function(){c.chainingBehavior.call(this);var t=function h(){var e=i(this,"ssfi");e&&s.includeStack===!1&&i(this,"ssfi",h);var t=c.method.apply(this,arguments);return t===undefined?this:t};if(o){var n=t.__proto__=Object.create(this);n.call=a,n.apply=f}else{var l=Object.getOwnPropertyNames(e);l.forEach(function(n){if(!u.test(n)){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r)}})}return r(this,t),t},configurable:!0})}},{"../config":4,"./flag":13,"./transferFlags":29}],10:[function(e,t,n){var r=e("../config"),i=e("./flag");t.exports=function(e,t,n){e[t]=function(){var s=i(this,"ssfi");s&&r.includeStack===!1&&i(this,"ssfi",e[t]);var o=n.apply(this,arguments);return o===undefined?this:o}}},{"../config":4,"./flag":13}],11:[function(e,t,n){var r=e("../config"),i=e("./flag");t.exports=function(e,t,n){Object.defineProperty(e,t,{get:function s(){var e=i(this,"ssfi");e&&r.includeStack===!1&&i(this,"ssfi",s);var t=n.call(this);return t===undefined?this:t},configurable:!0})}},{"../config":4,"./flag":13}],12:[function(e,t,n){var r=e("assertion-error"),i=e("./flag"),s=e("type-detect");t.exports=function(e,t){var e=i(e,"object");t=t.map(function(e){return e.toLowerCase()}),t.sort();var n=t.map(function(e,n){var r=~["a","e","i","o","u"].indexOf(e.charAt(0))?"an":"a",i=t.length>1&&n===t.length-1?"or ":"";return i+r+" "+e}).join(", ");if(!t.some(function(t){return s(e)===t}))throw new r("object tested must be "+n+", but "+s(e)+" given")}},{"./flag":13,"assertion-error":30,"type-detect":35}],13:[function(e,t,n){t.exports=function(e,t,n){var r=e.__flags||(e.__flags=Object.create(null));if(arguments.length!==3)return r[t];r[t]=n}},{}],14:[function(e,t,n){t.exports=function(e,t){return t.length>4?t[4]:e._obj}},{}],15:[function(e,t,n){t.exports=function(t){var n=[];for(var r in t)n.push(r);return n}},{}],16:[function(e,t,n){var r=e("./flag"),i=e("./getActual"),s=e("./inspect"),o=e("./objDisplay");t.exports=function(e,t){var n=r(e,"negate"),s=r(e,"object"),u=t[3],a=i(e,t),f=n?t[2]:t[1],l=r(e,"message");return typeof f=="function"&&(f=f()),f=f||"",f=f.replace(/#{this}/g,o(s)).replace(/#{act}/g,o(a)).replace(/#{exp}/g,o(u)),l?l+": "+f:f}},{"./flag":13,"./getActual":14,"./inspect":23,"./objDisplay":24}],17:[function(e,t,n){t.exports=function(e){if(e.name)return e.name;var t=/^\s?function ([^(]*)\(/.exec(e);return t&&t[1]?t[1]:""}},{}],18:[function(e,t,n){function i(e){var t=e.replace(/([^\\])\[/g,"$1.["),n=t.match(/(\\\.|[^.]+?)+/g);return n.map(function(e){var t=/^\[(\d+)\]$/,n=t.exec(e);return n?{i:parseFloat(n[1])}:{p:e.replace(/\\([.\[\]])/g,"$1")}})}function s(e,t,n){var r=t,i;n=n===undefined?e.length:n;for(var s=0,o=n;s<o;s++){var u=e[s];r?("undefined"!=typeof u.p?r=r[u.p]:"undefined"!=typeof u.i&&(r=r[u.i]),s==o-1&&(i=r)):i=undefined}return i}var r=e("./hasProperty");t.exports=function(t,n){var o=i(t),u=o[o.length-1],a={parent:o.length>1?s(o,n,o.length-1):n,name:u.p||u.i,value:s(o,n)};return a.exists=r(a.name,a.parent),a}},{"./hasProperty":21}],19:[function(e,t,n){var r=e("./getPathInfo");t.exports=function(e,t){var n=r(e,t);return n.value}},{"./getPathInfo":18}],20:[function(e,t,n){t.exports=function(t){function r(e){n.indexOf(e)===-1&&n.push(e)}var n=Object.getOwnPropertyNames(t),i=Object.getPrototypeOf(t);while(i!==null)Object.getOwnPropertyNames(i).forEach(r),i=Object.getPrototypeOf(i);return n}},{}],21:[function(e,t,n){var r=e("type-detect"),i={number:Number,string:String};t.exports=function(t,n){var s=r(n);return s==="null"||s==="undefined"?!1:(i[s]&&typeof n!="object"&&(n=new i[s](n)),t in n)}},{"type-detect":35}],22:[function(e,t,n){var n=t.exports={};n.test=e("./test"),n.type=e("type-detect"),n.expectTypes=e("./expectTypes"),n.getMessage=e("./getMessage"),n.getActual=e("./getActual"),n.inspect=e("./inspect"),n.objDisplay=e("./objDisplay"),n.flag=e("./flag"),n.transferFlags=e("./transferFlags"),n.eql=e("deep-eql"),n.getPathValue=e("./getPathValue"),n.getPathInfo=e("./getPathInfo"),n.hasProperty=e("./hasProperty"),n.getName=e("./getName"),n.addProperty=e("./addProperty"),n.addMethod=e("./addMethod"),n.overwriteProperty=e("./overwriteProperty"),n.overwriteMethod=e("./overwriteMethod"),n.addChainableMethod=e("./addChainableMethod"),n.overwriteChainableMethod=e("./overwriteChainableMethod")},{"./addChainableMethod":9,"./addMethod":10,"./addProperty":11,"./expectTypes":12,"./flag":13,"./getActual":14,"./getMessage":16,"./getName":17,"./getPathInfo":18,"./getPathValue":19,"./hasProperty":21,"./inspect":23,"./objDisplay":24,"./overwriteChainableMethod":25,"./overwriteMethod":26,"./overwriteProperty":27,"./test":28,"./transferFlags":29,"deep-eql":31,"type-detect":35}],23:[function(e,t,n){function o(e,t,n,r){var i={showHidden:t,seen:[],stylize:function(e){return e}};return a(i,e,typeof n=="undefined"?2:n)}function a(e,t,o){if(t&&typeof t.inspect=="function"&&t.inspect!==n.inspect&&(!t.constructor||t.constructor.prototype!==t)){var y=t.inspect(o);return typeof y!="string"&&(y=a(e,y,o)),y}var b=f(e,t);if(b)return b;if(u(t)){if("outerHTML"in t)return t.outerHTML;try{if(document.xmlVersion){var w=new XMLSerializer;return w.serializeToString(t)}var E="http://www.w3.org/1999/xhtml",S=document.createElementNS(E,"_");return S.appendChild(t.cloneNode(!1)),html=S.innerHTML.replace("><",">"+t.innerHTML+"<"),S.innerHTML="",html}catch(x){}}var T=s(t),N=e.showHidden?i(t):T;if(N.length===0||g(t)&&(N.length===1&&N[0]==="stack"||N.length===2&&N[0]==="description"&&N[1]==="stack")){if(typeof t=="function"){var C=r(t),k=C?": "+C:"";return e.stylize("[Function"+k+"]","special")}if(v(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(m(t))return e.stylize(Date.prototype.toUTCString.call(t),"date");if(g(t))return l(t)}var L="",A=!1,O=["{","}"];d(t)&&(A=!0,O=["[","]"]);if(typeof t=="function"){var C=r(t),k=C?": "+C:"";L=" [Function"+k+"]"}v(t)&&(L=" "+RegExp.prototype.toString.call(t)),m(t)&&(L=" "+Date.prototype.toUTCString.call(t));if(g(t))return l(t);if(N.length!==0||!!A&&t.length!=0){if(o<0)return v(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special");e.seen.push(t);var M;return A?M=c(e,t,o,T,N):M=N.map(function(n){return h(e,t,o,T,n,A)}),e.seen.pop(),p(M,L,O)}return O[0]+L+O[1]}function f(e,t){switch(typeof t){case"undefined":return e.stylize("undefined","undefined");case"string":var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string");case"number":if(t===0&&1/t===-Infinity)return e.stylize("-0","number");return e.stylize(""+t,"number");case"boolean":return e.stylize(""+t,"boolean")}if(t===null)return e.stylize("null","null")}function l(e){return"["+Error.prototype.toString.call(e)+"]"}function c(e,t,n,r,i){var s=[];for(var o=0,u=t.length;o<u;++o)Object.prototype.hasOwnProperty.call(t,String(o))?s.push(h(e,t,n,r,String(o),!0)):s.push("");return i.forEach(function(i){i.match(/^\d+$/)||s.push(h(e,t,n,r,i,!0))}),s}function h(e,t,n,r,i,s){var o,u;t.__lookupGetter__&&(t.__lookupGetter__(i)?t.__lookupSetter__(i)?u=e.stylize("[Getter/Setter]","special"):u=e.stylize("[Getter]","special"):t.__lookupSetter__(i)&&(u=e.stylize("[Setter]","special"))),r.indexOf(i)<0&&(o="["+i+"]"),u||(e.seen.indexOf(t[i])<0?(n===null?u=a(e,t[i],null):u=a(e,t[i],n-1),u.indexOf("\n")>-1&&(s?u=u.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):u="\n"+u.split("\n").map(function(e){return"   "+e}).join("\n"))):u=e.stylize("[Circular]","special"));if(typeof o=="undefined"){if(s&&i.match(/^\d+$/))return u;o=JSON.stringify(""+i),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+u}function p(e,t,n){var r=0,i=e.reduce(function(e,t){return r++,t.indexOf("\n")>=0&&r++,e+t.length+1},0);return i>60?n[0]+(t===""?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}function d(e){return Array.isArray(e)||typeof e=="object"&&y(e)==="[object Array]"}function v(e){return typeof e=="object"&&y(e)==="[object RegExp]"}function m(e){return typeof e=="object"&&y(e)==="[object Date]"}function g(e){return typeof e=="object"&&y(e)==="[object Error]"}function y(e){return Object.prototype.toString.call(e)}var r=e("./getName"),i=e("./getProperties"),s=e("./getEnumerableProperties");t.exports=o;var u=function(e){return typeof HTMLElement=="object"?e instanceof HTMLElement:e&&typeof e=="object"&&e.nodeType===1&&typeof e.nodeName=="string"}},{"./getEnumerableProperties":15,"./getName":17,"./getProperties":20}],24:[function(e,t,n){var r=e("./inspect"),i=e("../config");t.exports=function(e){var t=r(e),n=Object.prototype.toString.call(e);if(i.truncateThreshold&&t.length>=i.truncateThreshold){if(n==="[object Function]")return!e.name||e.name===""?"[Function]":"[Function: "+e.name+"]";if(n==="[object Array]")return"[ Array("+e.length+") ]";if(n==="[object Object]"){var s=Object.keys(e),o=s.length>2?s.splice(0,2).join(", ")+", ...":s.join(", ");return"{ Object ("+o+") }"}return t}return t}},{"../config":4,"./inspect":23}],25:[function(e,t,n){t.exports=function(e,t,n,r){var i=e.__methods[t],s=i.chainingBehavior;i.chainingBehavior=function(){var e=r(s).call(this);return e===undefined?this:e};var o=i.method;i.method=function(){var e=n(o).apply(this,arguments);return e===undefined?this:e}}},{}],26:[function(e,t,n){t.exports=function(e,t,n){var r=e[t],i=function(){return this};r&&"function"==typeof r&&(i=r),e[t]=function(){var e=n(i).apply(this,arguments);return e===undefined?this:e}}},{}],27:[function(e,t,n){t.exports=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e,t),i=function(){};r&&"function"==typeof r.get&&(i=r.get),Object.defineProperty(e,t,{get:function(){var e=n(i).call(this);return e===undefined?this:e},configurable:!0})}},{}],28:[function(e,t,n){var r=e("./flag");t.exports=function(e,t){var n=r(e,"negate"),i=t[0];return n?!i:i}},{"./flag":13}],29:[function(e,t,n){t.exports=function(e,t,n){var r=e.__flags||(e.__flags=Object.create(null));t.__flags||(t.__flags=Object.create(null)),n=arguments.length===3?n:!0;for(var i in r)if(n||i!=="object"&&i!=="ssfi"&&i!="message")t.__flags[i]=r[i]}},{}],30:[function(e,t,n){function r(){function t(t,n){Object.keys(n).forEach(function(r){~e.indexOf(r)||(t[r]=n[r])})}var e=[].slice.call(arguments);return function(){var n=[].slice.call(arguments),r=0,i={};for(;r<n.length;r++)t(i,n[r]);return i}}function i(e,t,n){var i=r("name","message","stack","constructor","toJSON"),s=i(t||{});this.message=e||"Unspecified AssertionError",this.showDiff=!1;for(var o in s)this[o]=s[o];n=n||arguments.callee,n&&Error.captureStackTrace?Error.captureStackTrace(this,n):this.stack=(new Error).stack}t.exports=i,i.prototype=Object.create(Error.prototype),i.prototype.name="AssertionError",i.prototype.constructor=i,i.prototype.toJSON=function(e){var t=r("constructor","toJSON","stack"),n=t({name:this.name},this);return!1!==e&&this.stack&&(n.stack=this.stack),n}},{}],31:[function(e,t,n){t.exports=e("./lib/eql")},{"./lib/eql":32}],32:[function(e,t,n){function o(e,t,n){return u(e,t)?!0:"date"===r(e)?f(e,t):"regexp"===r(e)?l(e,t):i.isBuffer(e)?d(e,t):"arguments"===r(e)?c(e,t,n):a(e,t)?"object"!==r(e)&&"object"!==r(t)&&"array"!==r(e)&&"array"!==r(t)?u(e,t):m(e,t,n):!1}function u(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function a(e,t){return r(e)===r(t)}function f(e,t){return"date"!==r(t)?!1:u(e.getTime(),t.getTime())}function l(e,t){return"regexp"!==r(t)?!1:u(e.toString(),t.toString())}function c(e,t,n){return"arguments"!==r(t)?!1:(e=[].slice.call(e),t=[].slice.call(t),o(e,t,n))}function h(e){var t=[];for(var n in e)t.push(n);return t}function p(e,t){if(e.length!==t.length)return!1;var n=0,r=!0;for(;n<e.length;n++)if(e[n]!==t[n]){r=!1;break}return r}function d(e,t){return i.isBuffer(t)?p(e,t):!1}function v(e){return e!==null&&e!==undefined}function m(e,t,n){if(!v(e)||!v(t))return!1;if(e.prototype!==t.prototype)return!1;var r;if(n){for(r=0;r<n.length;r++)if(n[r][0]===e&&n[r][1]===t||n[r][0]===t&&n[r][1]===e)return!0}else n=[];try{var i=h(e),s=h(t)}catch(u){return!1}i.sort(),s.sort();if(!p(i,s))return!1;n.push([e,t]);var a;for(r=i.length-1;r>=0;r--){a=i[r];if(!o(e[a],t[a],n))return!1}return!0}var r=e("type-detect"),i;try{i=e("buffer").Buffer}catch(s){i={},i.isBuffer=function(){return!1}}t.exports=o},{buffer:undefined,"type-detect":33}],33:[function(e,t,n){t.exports=e("./lib/type")},{"./lib/type":34}],34:[function(e,t,n){function i(e){var t=Object.prototype.toString.call(e);return r[t]?r[t]:e===null?"null":e===undefined?"undefined":e===Object(e)?"object":typeof e}function s(){this.tests={}}var n=t.exports=i,r={"[object Array]":"array","[object RegExp]":"regexp","[object Function]":"function","[object Arguments]":"arguments","[object Date]":"date"};n.Library=s,s.prototype.of=i,s.prototype.define=function(e,t){return arguments.length===1?this.tests[e]:(this.tests[e]=t,this)},s.prototype.test=function(e,t){if(t===i(e))return!0;var n=this.tests[t];if(n&&"regexp"===i(n))return n.test(e);if(n&&"function"===i(n))return n(e);throw new ReferenceError('Type test "'+t+'" not defined or invalid.')}},{}],35:[function(e,t,n){arguments[4][33][0].apply(n,arguments)},{"./lib/type":36,dup:33}],36:[function(e,t,n){function i(e){var t=Object.prototype.toString.call(e).match(r)[1].toLowerCase();return typeof Promise=="function"&&e instanceof Promise?"promise":e===null?"null":e===undefined?"undefined":t}function s(){if(!(this instanceof s))return new s;this.tests={}}var n=t.exports=i,r=/^\[object (.*)\]$/;n.Library=s,s.prototype.of=i,s.prototype.define=function(e,t){return arguments.length===1?this.tests[e]:(this.tests[e]=t,this)},s.prototype.test=function(e,t){if(t===i(e))return!0;var n=this.tests[t];if(n&&"regexp"===i(n))return n.test(e);if(n&&"function"===i(n))return n(e);throw new ReferenceError('Type test "'+t+'" not defined or invalid.')}},{}]},{},[1])(1)}),define("back4app-entity/utils/classes",["require","exports","module","util","chai"],function(e,t,n){function s(e,t){i(arguments).to.have.length(2,"Invalid argument length when generalizing classes (it has to be passed 2 arguments)"),i(e).to.be.a("function",'Invalid argument "GeneralClass" when generalizing classes (it has to be a function)'),i(t).to.be.a("function",'Invalid argument "SpecificClass" when generalizing classes (ut has to be a function)'),r.inherits(t,e);for(var n in e)n!=="super_"&&(t[n]=e[n])}function o(e,t){i(arguments).to.have.length(2,"Invalid argument length when checking if a class is general of another (it has to be passed 2 arguments)"),i(e).to.be.a("function",'Invalid argument "GeneralClass" when checking if a class is general of another (it has to be a function)'),i(t).to.be.a("function",'Invalid argument "SpecificClass" when checking if a class is general of another (it has to be a function)');var n=[],r=t;while(r&&n.indexOf(r)===-1){if(r===e)return!0;n.push(r),r=r.super_}return!1}var r=e("util"),i=e("chai").expect;n.exports={},n.exports.generalize=s,n.exports.isGeneral=o}),define("back4app-entity/utils/objects",["require","exports","module","chai"],function(e,t,n){function i(e){r(arguments).to.have.length(1,"Invalid argument length when copying an object (it has to be passed 1 argument)"),r(e).to.be.an("object",'Invalid argument "o" when copying an object (it has to be an object)');var t={};for(var n in e)t[n]=e[n];return t}var r=e("chai").expect;n.exports={},n.exports.copy=i}),define("back4app-entity/utils/index",["require","exports","module","./classes","./objects"],function(e,t,n){var r=e("./classes"),i=e("./objects");n.exports={},n.exports.classes=r,n.exports.objects=i}),define("back4app-entity/utils",["back4app-entity/utils/index"],function(e){return e}),define("back4app-entity/settings",["require","exports","module"],function(e,t,n){n.exports={},n.exports.ADAPTERS={}}),!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("bluebird",[],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.Promise=e()}}(function(){var define,module,exports;return function e(t,n,r){function i(o,u){if(!n[o]){if(!t[o]){var a=typeof _dereq_=="function"&&_dereq_;if(!u&&a)return a(o,!0);if(s)return s(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return i(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var s=typeof _dereq_=="function"&&_dereq_;for(var o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){"use strict";t.exports=function(e){function n(e){var n=new t(e),r=n.promise();return n.setHowMany(1),n.setUnwrap(),n.init(),r}var t=e._SomePromiseArray;e.any=function(e){return n(e)},e.prototype.any=function(){return n(this)}}},{}],2:[function(e,t,n){"use strict";function a(){this._isTickUsed=!1,this._lateQueue=new o(16),this._normalQueue=new o(16),this._trampolineEnabled=!0;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=s.isStatic?s(this.drainQueues):s}function f(e,t,n){this._lateQueue.push(e,t,n),this._queueTick()}function l(e,t,n){this._normalQueue.push(e,t,n),this._queueTick()}function c(e){this._normalQueue._pushOne(e),this._queueTick()}var r;try{throw new Error}catch(i){r=i}var s=e("./schedule.js"),o=e("./queue.js"),u=e("./util.js");a.prototype.disableTrampolineIfNecessary=function(){u.hasDevTools&&(this._trampolineEnabled=!1)},a.prototype.enableTrampoline=function(){this._trampolineEnabled||(this._trampolineEnabled=!0,this._schedule=function(e){setTimeout(e,0)})},a.prototype.haveItemsQueued=function(){return this._normalQueue.length()>0},a.prototype.throwLater=function(e,t){arguments.length===1&&(t=e,e=function(){throw t});if(typeof setTimeout!="undefined")setTimeout(function(){e(t)},0);else try{this._schedule(function(){e(t)})}catch(n){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")}},u.hasDevTools?(s.isStatic&&(s=function(e){setTimeout(e,0)}),a.prototype.invokeLater=function(e,t,n){this._trampolineEnabled?f.call(this,e,t,n):this._schedule(function(){setTimeout(function(){e.call(t,n)},100)})},a.prototype.invoke=function(e,t,n){this._trampolineEnabled?l.call(this,e,t,n):this._schedule(function(){e.call(t,n)})},a.prototype.settlePromises=function(e){this._trampolineEnabled?c.call(this,e):this._schedule(function(){e._settlePromises()})}):(a.prototype.invokeLater=f,a.prototype.invoke=l,a.prototype.settlePromises=c),a.prototype.invokeFirst=function(e,t,n){this._normalQueue.unshift(e,t,n),this._queueTick()},a.prototype._drainQueue=function(e){while(e.length()>0){var t=e.shift();if(typeof t!="function"){t._settlePromises();continue}var n=e.shift(),r=e.shift();t.call(n,r)}},a.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._drainQueue(this._lateQueue)},a.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},a.prototype._reset=function(){this._isTickUsed=!1},t.exports=new a,t.exports.firstLineError=r},{"./queue.js":28,"./schedule.js":31,"./util.js":38}],3:[function(e,t,n){"use strict";t.exports=function(e,t,n){var r=function(e,t){this._reject(t)},i=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(r,r,null,this,e)},s=function(e,t){this._isPending()&&this._resolveCallback(t.target)},o=function(e,t){t.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(r){var u=n(r),a=new e(t);a._propagateFrom(this,1);var f=this._target();a._setBoundTo(u);if(u instanceof e){var l={promiseRejectionQueued:!1,promise:a,target:f,bindingPromise:u};f._then(t,i,a._progress,a,l),u._then(s,o,a._progress,a,l)}else a._resolveCallback(f);return a},e.prototype._setBoundTo=function(e){e!==undefined?(this._bitField=this._bitField|131072,this._boundTo=e):this._bitField=this._bitField&-131073},e.prototype._isBound=function(){return(this._bitField&131072)===131072},e.bind=function(r,i){var s=n(r),o=new e(t);return o._setBoundTo(s),s instanceof e?s._then(function(){o._resolveCallback(i)},o._reject,o._progress,o,null):o._resolveCallback(i),o}}},{}],4:[function(e,t,n){"use strict";function i(){try{Promise===s&&(Promise=r)}catch(e){}return s}var r;typeof Promise!="undefined"&&(r=Promise);var s=e("./promise.js")();s.noConflict=i,t.exports=s},{"./promise.js":23}],5:[function(e,t,n){"use strict";var r=Object.create;if(r){var i=r(null),s=r(null);i[" size"]=s[" size"]=0}t.exports=function(t){function h(e,r){var i;e!=null&&(i=e[r]);if(typeof i!="function"){var s="Object "+n.classString(e)+" has no method '"+n.toString(r)+"'";throw new t.TypeError(s)}return i}function p(e){var t=this.pop(),n=h(e,t);return n.apply(e,this)}function d(e){return e[this]}function v(e){var t=+this;return t<0&&(t=Math.max(0,t+e.length)),e[t]}var n=e("./util.js"),r=n.canEvaluate,o=n.isIdentifier,u,a;t.prototype.call=function(e){var t=arguments.length,n=new Array(t-1);for(var i=1;i<t;++i)n[i-1]=arguments[i];return n.push(e),this._then(p,undefined,undefined,n,undefined)},t.prototype.get=function(e){var t=typeof e=="number",n;if(!t)if(r){var i=a(e);n=i!==null?i:d}else n=d;else n=v;return this._then(n,undefined,undefined,e,undefined)}}},{"./util.js":38}],6:[function(e,t,n){"use strict";t.exports=function(t){var n=e("./errors.js"),r=e("./async.js"),i=n.CancellationError;t.prototype._cancel=function(e){if(!this.isCancellable())return this;var t,n=this;while((t=n._cancellationParent)!==undefined&&t.isCancellable())n=t;this._unsetCancellable(),n._target()._rejectCallback(e,!1,!0)},t.prototype.cancel=function(e){return this.isCancellable()?(e===undefined&&(e=new i),r.invokeLater(this._cancel,this,e),this):this},t.prototype.cancellable=function(){return this._cancellable()?this:(r.enableTrampoline(),this._setCancellable(),this._cancellationParent=undefined,this)},t.prototype.uncancellable=function(){var e=this.then();return e._unsetCancellable(),e},t.prototype.fork=function(e,t,n){var r=this._then(e,t,n,undefined,undefined);return r._setCancellable(),r._cancellationParent=undefined,r}}},{"./async.js":2,"./errors.js":13}],7:[function(e,t,n){"use strict";t.exports=function(){function a(e){this._parent=e;var t=this._length=1+(e===undefined?0:e._length);b(this,a),t>32&&this.uncycle()}function f(e,t){for(var n=0;n<t.length-1;++n)t[n].push("From previous event:"),t[n]=t[n].join("\n");return n<t.length&&(t[n]=t[n].join("\n")),e+"\n"+t.join("\n")}function l(e){for(var t=0;t<e.length;++t)if(e[t].length===0||t+1<e.length&&e[t][0]===e[t+1][0])e.splice(t,1),t--}function c(e){var t=e[0];for(var n=1;n<e.length;++n){var r=e[n],i=t.length-1,s=t[i],o=-1;for(var u=r.length-1;u>=0;--u)if(r[u]===s){o=u;break}for(var u=o;u>=0;--u){var a=r[u];if(t[i]!==a)break;t.pop(),i--}t=r}}function h(e){var t=[];for(var n=0;n<e.length;++n){var r=e[n],s=i.test(r)||"    (No stack trace)"===r,u=s&&m(r);s&&!u&&(o&&r.charAt(0)!==" "&&(r="    "+r),t.push(r))}return t}function p(e){var t=e.stack.replace(/\s+$/g,"").split("\n");for(var n=0;n<t.length;++n){var r=t[n];if("    (No stack trace)"===r||i.test(r))break}return n>0&&(t=t.slice(n)),t}function d(e){var t;if(typeof e=="function")t="[function "+(e.name||"anonymous")+"]";else{t=e.toString();var n=/\[object [a-zA-Z0-9$_]+\]/;if(n.test(t))try{var r=JSON.stringify(e);t=r}catch(i){}t.length===0&&(t="(empty array)")}return"(<"+v(t)+">, no stack trace)"}function v(e){var t=41;return e.length<t?e:e.substr(0,t-3)+"..."}function y(e){var t=e.match(g);if(t)return{fileName:t[1],line:parseInt(t[2],10)}}var t=e("./async.js"),n=e("./util.js"),r=/[\\\/]bluebird[\\\/]js[\\\/](main|debug|zalgo|instrumented)/,i=null,s=null,o=!1,u;n.inherits(a,Error),a.prototype.uncycle=function(){var e=this._length;if(e<2)return;var t=[],n={};for(var r=0,i=this;i!==undefined;++r)t.push(i),i=i._parent;e=this._length=r;for(var r=e-1;r>=0;--r){var s=t[r].stack;n[s]===undefined&&(n[s]=r)}for(var r=0;r<e;++r){var o=t[r].stack,u=n[o];if(u!==undefined&&u!==r){u>0&&(t[u-1]._parent=undefined,t[u-1]._length=1),t[r]._parent=undefined,t[r]._length=1;var a=r>0?t[r-1]:this;u<e-1?(a._parent=t[u+1],a._parent.uncycle(),a._length=a._parent._length+1):(a._parent=undefined,a._length=1);var f=a._length+1;for(var l=r-2;l>=0;--l)t[l]._length=f,f++;return}}},a.prototype.parent=function(){return this._parent},a.prototype.hasParent=function(){return this._parent!==undefined},a.prototype.attachExtraTrace=function(e){if(e.__stackCleaned__)return;this.uncycle();var t=a.parseStackAndMessage(e),r=t.message,i=[t.stack],s=this;while(s!==undefined)i.push(h(s.stack.split("\n"))),s=s._parent;c(i),l(i),n.notEnumerableProp(e,"stack",f(r,i)),n.notEnumerableProp(e,"__stackCleaned__",!0)},a.parseStackAndMessage=function(e){var t=e.stack,n=e.toString();return t=typeof t=="string"&&t.length>0?p(e):["    (No stack trace)"],{message:n,stack:h(t)}},a.formatAndLogError=function(e,t){if(typeof console!="undefined"){var n;if(typeof e=="object"||typeof e=="function"){var r=e.stack;n=t+s(r,e)}else n=t+String(e);typeof u=="function"?u(n):(typeof console.log=="function"||typeof console.log=="object")&&console.log(n)}},a.unhandledRejection=function(e){a.formatAndLogError(e,"^--- With additional stack trace: ")},a.isSupported=function(){return typeof b=="function"},a.fireRejectionEvent=function(e,n,r,i){var s=!1;try{typeof n=="function"&&(s=!0,e==="rejectionHandled"?n(i):n(r,i))}catch(o){t.throwLater(o)}var u=!1;try{u=E(e,r,i)}catch(o){u=!0,t.throwLater(o)}var f=!1;if(w)try{f=w(e.toLowerCase(),{reason:r,promise:i})}catch(o){f=!0,t.throwLater(o)}!u&&!s&&!f&&e==="unhandledRejection"&&a.formatAndLogError(r,"Unhandled rejection ")};var m=function(){return!1},g=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;a.setBounds=function(e,t){if(!a.isSupported())return;var n=e.stack.split("\n"),i=t.stack.split("\n"),s=-1,o=-1,u,f;for(var l=0;l<n.length;++l){var c=y(n[l]);if(c){u=c.fileName,s=c.line;break}}for(var l=0;l<i.length;++l){var c=y(i[l]);if(c){f=c.fileName,o=c.line;break}}if(s<0||o<0||!u||!f||u!==f||s>=o)return;m=function(e){if(r.test(e))return!0;var t=y(e);return t&&t.fileName===u&&s<=t.line&&t.line<=o?!0:!1}};var b=function(){var t=/^\s*at\s*/,n=function(e,t){return typeof e=="string"?e:t.name!==undefined&&t.message!==undefined?t.toString():d(t)};if(typeof Error.stackTraceLimit=="number"&&typeof Error.captureStackTrace=="function"){Error.stackTraceLimit=Error.stackTraceLimit+6,i=t,s=n;var u=Error.captureStackTrace;return m=function(e){return r.test(e)},function(e,t){Error.stackTraceLimit=Error.stackTraceLimit+6,u(e,t),Error.stackTraceLimit=Error.stackTraceLimit-6}}var a=new Error;if(typeof a.stack=="string"&&a.stack.split("\n")[0].indexOf("stackDetection@")>=0)return i=/@/,s=n,o=!0,function(t){t.stack=(new Error).stack};var f;try{throw new Error}catch(l){f="stack"in l}return"stack"in a||!f||typeof Error.stackTraceLimit!="number"?(s=function(e,t){return typeof e=="string"?e:typeof t!="object"&&typeof t!="function"||t.name===undefined||t.message===undefined?d(t):t.toString()},null):(i=t,s=n,function(t){Error.stackTraceLimit=Error.stackTraceLimit+6;try{throw new Error}catch(n){t.stack=n.stack}Error.stackTraceLimit=Error.stackTraceLimit-6})}([]),w,E=function(){if(n.isNode)return function(e,t,n){return e==="rejectionHandled"?process.emit(e,n):process.emit(e,t,n)};var e=!1,t=!0;try{var r=new self.CustomEvent("test");e=r instanceof CustomEvent}catch(i){}if(!e)try{var s=document.createEvent("CustomEvent");s.initCustomEvent("testingtheevent",!1,!0,{}),self.dispatchEvent(s)}catch(i){t=!1}t&&(w=function(t,n){var r;return e?r=new self.CustomEvent(t,{detail:n,bubbles:!1,cancelable:!0}):self.dispatchEvent&&(r=document.createEvent("CustomEvent"),r.initCustomEvent(t,!1,!0,n)),r?!self.dispatchEvent(r):!1});var o={};return o.unhandledRejection="onunhandledRejection".toLowerCase(),o.rejectionHandled="onrejectionHandled".toLowerCase(),function(e,t,n){var r=o[e],i=self[r];return i?(e==="rejectionHandled"?i.call(self,n):i.call(self,t,n),!0):!1}}();return typeof console!="undefined"&&typeof console.warn!="undefined"&&(u=function(e){console.warn(e)},n.isNode&&process.stderr.isTTY?u=function(e){process.stderr.write("[31m"+e+"[39m\n")}:!n.isNode&&typeof (new Error).stack=="string"&&(u=function(e){console.warn("%c"+e,"color: red")})),a}},{"./async.js":2,"./util.js":38}],8:[function(e,t,n){"use strict";t.exports=function(t){function a(e,t,n){this._instances=e,this._callback=t,this._promise=n}function f(e,t){var n={},r=i(e).call(n,t);if(r===s)return r;var a=o(n);return a.length?(s.e=new u("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"),s):r}var n=e("./util.js"),r=e("./errors.js"),i=n.tryCatch,s=n.errorObj,o=e("./es5.js").keys,u=r.TypeError;return a.prototype.doFilter=function(e){var n=this._callback,r=this._promise,o=r._boundValue();for(var u=0,a=this._instances.length;u<a;++u){var l=this._instances[u],c=l===Error||l!=null&&l.prototype instanceof Error;if(c&&e instanceof l){var h=i(n).call(o,e);return h===s?(t.e=h.e,t):h}if(typeof l=="function"&&!c){var p=f(l,e);if(p===s){e=s.e;break}if(p){var h=i(n).call(o,e);return h===s?(t.e=h.e,t):h}}}return t.e=e,t},a}},{"./errors.js":13,"./es5.js":14,"./util.js":38}],9:[function(e,t,n){"use strict";t.exports=function(e,t,n){function i(){this._trace=new t(o())}function s(){if(n())return new i}function o(){var e=r.length-1;return e>=0?r[e]:undefined}var r=[];return i.prototype._pushContext=function(){if(!n())return;this._trace!==undefined&&r.push(this._trace)},i.prototype._popContext=function(){if(!n())return;this._trace!==undefined&&r.pop()},e.prototype._peekContext=o,e.prototype._pushContext=i.prototype._pushContext,e.prototype._popContext=i.prototype._popContext,s}},{}],10:[function(e,t,n){"use strict";t.exports=function(t,n){var r=t._getDomain,i=e("./async.js"),s=e("./errors.js").Warning,o=e("./util.js"),u=o.canAttachTrace,a,f,l=o.isNode&&(!!process.env.BLUEBIRD_DEBUG||process.env.NODE_ENV==="development");return o.isNode&&process.env["BLUEBIRD_DEBUG"]==0&&(l=!1),l&&i.disableTrampolineIfNecessary(),t.prototype._ignoreRejections=function(){this._unsetRejectionIsUnhandled(),this._bitField=this._bitField|16777216},t.prototype._ensurePossibleRejectionHandled=function(){if((this._bitField&16777216)!==0)return;this._setRejectionIsUnhandled(),i.invokeLater(this._notifyUnhandledRejection,this,undefined)},t.prototype._notifyUnhandledRejectionIsHandled=function(){n.fireRejectionEvent("rejectionHandled",a,undefined,this)},t.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._getCarriedStackTrace()||this._settledValue;this._setUnhandledRejectionIsNotified(),n.fireRejectionEvent("unhandledRejection",f,e,this)}},t.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=this._bitField|524288},t.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=this._bitField&-524289},t.prototype._isUnhandledRejectionNotified=function(){return(this._bitField&524288)>0},t.prototype._setRejectionIsUnhandled=function(){this._bitField=this._bitField|2097152},t.prototype._unsetRejectionIsUnhandled=function(){this._bitField=this._bitField&-2097153,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},t.prototype._isRejectionUnhandled=function(){return(this._bitField&2097152)>0},t.prototype._setCarriedStackTrace=function(e){this._bitField=this._bitField|1048576,this._fulfillmentHandler0=e},t.prototype._isCarryingStackTrace=function(){return(this._bitField&1048576)>0},t.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:undefined},t.prototype._captureStackTrace=function(){return l&&(this._trace=new n(this._peekContext())),this},t.prototype._attachExtraTrace=function(e,t){if(l&&u(e)){var r=this._trace;r!==undefined&&t&&(r=r._parent);if(r!==undefined)r.attachExtraTrace(e);else if(!e.__stackCleaned__){var i=n.parseStackAndMessage(e);o.notEnumerableProp(e,"stack",i.message+"\n"+i.stack.join("\n")),o.notEnumerableProp(e,"__stackCleaned__",!0)}}},t.prototype._warn=function(e){var t=new s(e),r=this._peekContext();if(r)r.attachExtraTrace(t);else{var i=n.parseStackAndMessage(t);t.stack=i.message+"\n"+i.stack.join("\n")}n.formatAndLogError(t,"")},t.onPossiblyUnhandledRejection=function(e){var t=r();f=typeof e=="function"?t===null?e:t.bind(e):undefined},t.onUnhandledRejectionHandled=function(e){var t=r();a=typeof e=="function"?t===null?e:t.bind(e):undefined},t.longStackTraces=function(){if(i.haveItemsQueued()&&l===!1)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/DT1qyG\n");l=n.isSupported(),l&&i.disableTrampolineIfNecessary()},t.hasLongStackTraces=function(){return l&&n.isSupported()},n.isSupported()||(t.longStackTraces=function(){},l=!1),function(){return l}}},{"./async.js":2,"./errors.js":13,"./util.js":38}],11:[function(e,t,n){"use strict";var r=e("./util.js"),i=r.isPrimitive;t.exports=function(e){var t=function(){return this},n=function(){throw this},r=function(){},s=function(){throw undefined},o=function(e,t){if(t===1)return function(){throw e};if(t===2)return function(){return e}};e.prototype["return"]=e.prototype.thenReturn=function(n){return n===undefined?this.then(r):i(n)?this._then(o(n,2),undefined,undefined,undefined,undefined):(n instanceof e&&n._ignoreRejections(),this._then(t,undefined,undefined,n,undefined))},e.prototype["throw"]=e.prototype.thenThrow=function(e){return e===undefined?this.then(s):i(e)?this._then(o(e,1),undefined,undefined,undefined,undefined):this._then(n,undefined,undefined,e,undefined)}}},{"./util.js":38}],12:[function(e,t,n){"use strict";t.exports=function(e,t){var n=e.reduce;e.prototype.each=function(e){return n(this,e,null,t)},e.each=function(e,r){return n(e,r,null,t)}}},{}],13:[function(e,t,n){"use strict";function a(e,t){function n(r){if(!(this instanceof n))return new n(r);u(this,"message",typeof r=="string"?r:t),u(this,"name",e),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return o(n,Error),n}function b(e){if(!(this instanceof b))return new b(e);u(this,"name","OperationalError"),u(this,"message",e),this.cause=e,this.isOperational=!0,e instanceof Error?(u(this,"message",e.message),u(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}var r=e("./es5.js"),i=r.freeze,s=e("./util.js"),o=s.inherits,u=s.notEnumerableProp,f,l,c=a("Warning","warning"),h=a("CancellationError","cancellation error"),p=a("TimeoutError","timeout error"),d=a("AggregateError","aggregate error");try{f=TypeError,l=RangeError}catch(v){f=a("TypeError","type error"),l=a("RangeError","range error")}var m="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" ");for(var g=0;g<m.length;++g)typeof Array.prototype[m[g]]=="function"&&(d.prototype[m[g]]=Array.prototype[m[g]]);r.defineProperty(d.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),d.prototype.isOperational=!0;var y=0;d.prototype.toString=function(){var e=Array(y*4+1).join(" "),t="\n"+e+"AggregateError of:"+"\n";y++,e=Array(y*4+1).join(" ");for(var n=0;n<this.length;++n){var r=this[n]===this?"[Circular AggregateError]":this[n]+"",i=r.split("\n");for(var s=0;s<i.length;++s)i[s]=e+i[s];r=i.join("\n"),t+=r+"\n"}return y--,t},o(b,Error);var w=Error.__BluebirdErrorTypes__;w||(w=i({CancellationError:h,TimeoutError:p,OperationalError:b,RejectionError:b,AggregateError:d}),u(Error,"__BluebirdErrorTypes__",w)),t.exports={Error:Error,TypeError:f,RangeError:l,CancellationError:w.CancellationError,OperationalError:w.OperationalError,TimeoutError:w.TimeoutError,AggregateError:w.AggregateError,Warning:c}},{"./es5.js":14,"./util.js":38}],14:[function(e,t,n){var r=function(){"use strict";return this===undefined}();if(r)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(e,t){var n=Object.getOwnPropertyDescriptor(e,t);return!!(!n||n.writable||n.set)}};else{var i={}.hasOwnProperty,s={}.toString,o={}.constructor.prototype,u=function(e){var t=[];for(var n in e)i.call(e,n)&&t.push(n);return t},a=function(e,t){return{value:e[t]}},f=function(e,t,n){return e[t]=n.value,e},l=function(e){return e},c=function(e){try{return Object(e).constructor.prototype}catch(t){return o}},h=function(e){try{return s.call(e)==="[object Array]"}catch(t){return!1}};t.exports={isArray:h,keys:u,names:u,defineProperty:f,getDescriptor:a,freeze:l,getPrototypeOf:c,isES5:r,propertyIsWritable:function(){return!0}}}},{}],15:[function(e,t,n){"use strict";t.exports=function(e,t){var n=e.map;e.prototype.filter=function(e,r){return n(this,e,r,t)},e.filter=function(e,r,i){return n(e,r,i,t)}}},{}],16:[function(e,t,n){"use strict";t.exports=function(t,n,r){function u(){return this}function a(){throw this}function f(e){return function(){return e}}function l(e){return function(){throw e}}function c(e,t,n){var r;return s(t)?r=n?f(t):l(t):r=n?u:a,e._then(r,o,undefined,t,undefined)}function h(e){var i=this.promise,s=this.handler,o=i._isBound()?s.call(i._boundValue()):s();if(o!==undefined){var u=r(o,i);if(u instanceof t)return u=u._target(),c(u,e,i.isFulfilled())}return i.isRejected()?(n.e=e,n):e}function p(e){var n=this.promise,i=this.handler,s=n._isBound()?i.call(n._boundValue(),e):i(e);if(s!==undefined){var o=r(s,n);if(o instanceof t)return o=o._target(),c(o,e,!0)}return e}var i=e("./util.js"),s=i.isPrimitive,o=i.thrower;t.prototype._passThroughHandler=function(e,t){if(typeof e!="function")return this.then();var n={promise:this,handler:e};return this._then(t?h:p,t?h:undefined,undefined,n,undefined)},t.prototype.lastly=t.prototype["finally"]=function(e){return this._passThroughHandler(e,!0)},t.prototype.tap=function(e){return this._passThroughHandler(e,!1)}}},{"./util.js":38}],17:[function(e,t,n){"use strict";t.exports=function(t,n,r,i){function c(e,n,r){for(var s=0;s<n.length;++s){r._pushContext();var o=f(n[s])(e);r._popContext();if(o===a){r._pushContext();var u=t.reject(a.e);return r._popContext(),u}var l=i(o,r);if(l instanceof t)return l}return null}function h(e,n,i,s){var o=this._promise=new t(r);o._captureStackTrace(),this._stack=s,this._generatorFunction=e,this._receiver=n,this._generator=undefined,this._yieldHandlers=typeof i=="function"?[i].concat(l):l}var s=e("./errors.js"),o=s.TypeError,u=e("./util.js"),a=u.errorObj,f=u.tryCatch,l=[];h.prototype.promise=function(){return this._promise},h.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=undefined,this._next(undefined)},h.prototype._continue=function(e){if(e===a)return this._promise._rejectCallback(e.e,!1,!0);var n=e.value;if(e.done===!0)this._promise._resolveCallback(n);else{var r=i(n,this._promise);if(!(r instanceof t)){r=c(r,this._yieldHandlers,this._promise);if(r===null){this._throw(new o("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/4Y4pDk\n\n".replace("%s",n)+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));return}}r._then(this._next,this._throw,undefined,this,null)}},h.prototype._throw=function(e){this._promise._attachExtraTrace(e),this._promise._pushContext();var t=f(this._generator["throw"]).call(this._generator,e);this._promise._popContext(),this._continue(t)},h.prototype._next=function(e){this._promise._pushContext();var t=f(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(t)},t.coroutine=function(e,t){if(typeof e!="function")throw new o("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n");var n=Object(t).yieldHandler,r=h,i=(new Error).stack;return function(){var t=e.apply(this,arguments),s=new r(undefined,undefined,n,i);return s._generator=t,s._next(undefined),s.promise()}},t.coroutine.addYieldHandler=function(e){if(typeof e!="function")throw new o("fn must be a function\n\n    See http://goo.gl/916lJJ\n");l.push(e)},t.spawn=function(e){if(typeof e!="function")return n("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n");var r=new h(e,this),i=r.promise();return r._run(t.spawn),i}}},{"./errors.js":13,"./util.js":38}],18:[function(e,t,n){"use strict";t.exports=function(t,n,r,i){var s=e("./util.js"),o=s.canEvaluate,u=s.tryCatch,a=s.errorObj,f;t.join=function(){var e=arguments.length-1,s;e>0&&typeof arguments[e]=="function"&&(s=arguments[e]);var d=arguments.length,m=new Array(d);for(var g=0;g<d;++g)m[g]=arguments[g];s&&m.pop();var u=(new n(m)).promise();return s!==undefined?u.spread(s):u}}},{"./util.js":38}],19:[function(e,t,n){"use strict";t.exports=function(t,n,r,i,s){function p(e,t,n,r){this.constructor$(e),this._promise._captureStackTrace();var i=o();this._callback=i===null?t:i.bind(t),this._preservedValues=r===s?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=n>=1?[]:h,u.invoke(d,this,undefined)}function d(){this._init$(undefined,-2)}function v(e,t,n,r){var i=typeof n=="object"&&n!==null?n.concurrency:0;return i=typeof i=="number"&&isFinite(i)&&i>=1?i:0,new p(e,t,i,r)}var o=t._getDomain,u=e("./async.js"),a=e("./util.js"),f=a.tryCatch,l=a.errorObj,c={},h=[];a.inherits(p,n),p.prototype._init=function(){},p.prototype._promiseFulfilled=function(e,n){var r=this._values,s=this.length(),o=this._preservedValues,u=this._limit;if(r[n]===c){r[n]=e;if(u>=1){this._inFlight--,this._drainQueue();if(this._isResolved())return}}else{if(u>=1&&this._inFlight>=u){r[n]=e,this._queue.push(n);return}o!==null&&(o[n]=e);var a=this._callback,h=this._promise._boundValue();this._promise._pushContext();var p=f(a).call(h,e,n,s);this._promise._popContext();if(p===l)return this._reject(p.e);var d=i(p,this._promise);if(d instanceof t){d=d._target();if(d._isPending())return u>=1&&this._inFlight++,r[n]=c,d._proxyPromiseArray(this,n);if(!d._isFulfilled())return this._reject(d._reason());p=d._value()}r[n]=p}var v=++this._totalResolved;v>=s&&(o!==null?this._filter(r,o):this._resolve(r))},p.prototype._drainQueue=function(){var e=this._queue,t=this._limit,n=this._values;while(e.length>0&&this._inFlight<t){if(this._isResolved())return;var r=e.pop();this._promiseFulfilled(n[r],r)}},p.prototype._filter=function(e,t){var n=t.length,r=new Array(n),i=0;for(var s=0;s<n;++s)e[s]&&(r[i++]=t[s]);r.length=i,this._resolve(r)},p.prototype.preservedValues=function(){return this._preservedValues},t.prototype.map=function(e,t){return typeof e!="function"?r("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):v(this,e,t,null).promise()},t.map=function(e,t,n,i){return typeof t!="function"?r("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):v(e,t,n,i).promise()}}},{"./async.js":2,"./util.js":38}],20:[function(e,t,n){"use strict";t.exports=function(t,n,r,i){var s=e("./util.js"),o=s.tryCatch;t.method=function(e){if(typeof e!="function")throw new t.TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n");return function(){var r=new t(n);r._captureStackTrace(),r._pushContext();var i=o(e).apply(this,arguments);return r._popContext(),r._resolveFromSyncValue(i),r}},t.attempt=t["try"]=function(e,r,u){if(typeof e!="function")return i("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var a=new t(n);a._captureStackTrace(),a._pushContext();var f=s.isArray(r)?o(e).apply(u,r):o(e).call(u,r);return a._popContext(),a._resolveFromSyncValue(f),a},t.prototype._resolveFromSyncValue=function(e){e===s.errorObj?this._rejectCallback(e.e,!1,!0):this._resolveCallback(e,!0)}}},{"./util.js":38}],21:[function(e,t,n){"use strict";t.exports=function(t){function o(e,t){var o=this;if(!n.isArray(e))return u.call(o,e,t);var a=i(t).apply(o._boundValue(),[null].concat(e));a===s&&r.throwLater(a.e)}function u(e,t){var n=this,o=n._boundValue(),u=e===undefined?i(t).call(o,null):i(t).call(o,null,e);u===s&&r.throwLater(u.e)}function a(e,t){var n=this;if(!e){var o=n._target(),u=o._getCarriedStackTrace();u.cause=e,e=u}var a=i(t).call(n._boundValue(),e);a===s&&r.throwLater(a.e)}var n=e("./util.js"),r=e("./async.js"),i=n.tryCatch,s=n.errorObj;t.prototype.asCallback=t.prototype.nodeify=function(e,t){if(typeof e=="function"){var n=u;t!==undefined&&Object(t).spread&&(n=o),this._then(n,a,undefined,this,e)}return this}}},{"./async.js":2,"./util.js":38}],22:[function(e,t,n){"use strict";t.exports=function(t,n){var r=e("./util.js"),i=e("./async.js"),s=r.tryCatch,o=r.errorObj;t.prototype.progressed=function(e){return this._then(undefined,undefined,e,undefined,undefined)},t.prototype._progress=function(e){if(this._isFollowingOrFulfilledOrRejected())return;this._target()._progressUnchecked(e)},t.prototype._progressHandlerAt=function(e){return e===0?this._progressHandler0:this[(e<<2)+e-5+2]},t.prototype._doProgressWith=function(e){var n=e.value,i=e.handler,u=e.promise,a=e.receiver,f=s(i).call(a,n);if(f===o){if(f.e!=null&&f.e.name!=="StopProgressPropagation"){var l=r.canAttachTrace(f.e)?f.e:new Error(r.toString(f.e));u._attachExtraTrace(l),u._progress(f.e)}}else f instanceof t?f._then(u._progress,null,null,u,undefined):u._progress(f)},t.prototype._progressUnchecked=function(e){var r=this._length(),s=this._progress;for(var o=0;o<r;o++){var u=this._progressHandlerAt(o),a=this._promiseAt(o);if(!(a instanceof t)){var f=this._receiverAt(o);typeof u=="function"?u.call(f,e,a):f instanceof n&&!f._isResolved()&&f._promiseProgressed(e,a);continue}typeof u=="function"?i.invoke(this._doProgressWith,this,{handler:u,promise:a,receiver:this._receiverAt(o),value:e}):i.invoke(s,a,e)}}}},{"./async.js":2,"./util.js":38}],23:[function(e,t,n){"use strict";t.exports=function(){function x(e){if(typeof e!="function")throw new f("the promise constructor requires a resolver function\n\n    See http://goo.gl/EC22Yn\n");if(this.constructor!==x)throw new f("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/KsIlge\n");this._bitField=0,this._fulfillmentHandler0=undefined,this._rejectionHandler0=undefined,this._progressHandler0=undefined,this._promise0=undefined,this._receiver0=undefined,this._settledValue=undefined,e!==l&&this._resolveFromResolver(e)}function T(e){var t=new x(l);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._progressHandler0=e,t._promise0=e,t._receiver0=e,t._settledValue=e}var t=function(){return new f("circular promise resolution chain\n\n    See http://goo.gl/LhFpo0\n")},n=function(){return new x.PromiseInspection(this._target())},r=function(e){return x.reject(new f(e))},i=e("./util.js"),s;i.isNode?s=function(){var e=process.domain;return e===undefined&&(e=null),e}:s=function(){return null},i.notEnumerableProp(x,"_getDomain",s);var o={},u=e("./async.js"),a=e("./errors.js"),f=x.TypeError=a.TypeError;x.RangeError=a.RangeError,x.CancellationError=a.CancellationError,x.TimeoutError=a.TimeoutError,x.OperationalError=a.OperationalError,x.RejectionError=a.OperationalError,x.AggregateError=a.AggregateError;var l=function(){},c={},h={e:null},p=e("./thenables.js")(x,l),d=e("./promise_array.js")(x,l,p,r),v=e("./captured_trace.js")(),m=e("./debuggability.js")(x,v),g=e("./context.js")(x,v,m),y=e("./catch_filter.js")(h),b=e("./promise_resolver.js"),w=b._nodebackForPromise,E=i.errorObj,S=i.tryCatch;return x.prototype.toString=function(){return"[object Promise]"},x.prototype.caught=x.prototype["catch"]=function(e){var t=arguments.length;if(t>1){var n=new Array(t-1),r=0,i;for(i=0;i<t-1;++i){var s=arguments[i];if(typeof s!="function")return x.reject(new f("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"));n[r++]=s}n.length=r,e=arguments[i];var o=new y(n,e,this);return this._then(undefined,o.doFilter,undefined,o,undefined)}return this._then(undefined,e,undefined,undefined,undefined)},x.prototype.reflect=function(){return this._then(n,n,undefined,this,undefined)},x.prototype.then=function(e,t,n){if(m()&&arguments.length>0&&typeof e!="function"&&typeof t!="function"){var r=".then() only accepts functions but was passed: "+i.classString(e);arguments.length>1&&(r+=", "+i.classString(t)),this._warn(r)}return this._then(e,t,n,undefined,undefined)},x.prototype.done=function(e,t,n){var r=this._then(e,t,n,undefined,undefined);r._setIsFinal()},x.prototype.spread=function(e,t){return this.all()._then(e,t,undefined,c,undefined)},x.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()},x.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:undefined,rejectionReason:undefined};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},x.prototype.all=function(){return(new d(this)).promise()},x.prototype.error=function(e){return this.caught(i.originatesFromRejection,e)},x.is=function(e){return e instanceof x},x.fromNode=function(e){var t=new x(l),n=S(e)(w(t));return n===E&&t._rejectCallback(n.e,!0,!0),t},x.all=function(e){return(new d(e)).promise()},x.defer=x.pending=function(){var e=new x(l);return new b(e)},x.cast=function(e){var t=p(e);if(!(t instanceof x)){var n=t;t=new x(l),t._fulfillUnchecked(n)}return t},x.resolve=x.fulfilled=x.cast,x.reject=x.rejected=function(e){var t=new x(l);return t._captureStackTrace(),t._rejectCallback(e,!0),t},x.setScheduler=function(e){if(typeof e!="function")throw new f("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var t=u._schedule;return u._schedule=e,t},x.prototype._then=function(e,t,n,r,i){var o=i!==undefined,a=o?i:new x(l);o||(a._propagateFrom(this,5),a._captureStackTrace());var f=this._target();f!==this&&(r===undefined&&(r=this._boundTo),o||a._setIsMigrated());var c=f._addCallbacks(e,t,n,a,r,s());return f._isResolved()&&!f._isSettlePromisesQueued()&&u.invoke(f._settlePromiseAtPostResolution,f,c),a},x.prototype._settlePromiseAtPostResolution=function(e){this._isRejectionUnhandled()&&this._unsetRejectionIsUnhandled(),this._settlePromiseAt(e)},x.prototype._length=function(){return this._bitField&131071},x.prototype._isFollowingOrFulfilledOrRejected=function(){return(this._bitField&939524096)>0},x.prototype._isFollowing=function(){return(this._bitField&536870912)===536870912},x.prototype._setLength=function(e){this._bitField=this._bitField&-131072|e&131071},x.prototype._setFulfilled=function(){this._bitField=this._bitField|268435456},x.prototype._setRejected=function(){this._bitField=this._bitField|134217728},x.prototype._setFollowing=function(){this._bitField=this._bitField|536870912},x.prototype._setIsFinal=function(){this._bitField=this._bitField|33554432},x.prototype._isFinal=function(){return(this._bitField&33554432)>0},x.prototype._cancellable=function(){return(this._bitField&67108864)>0},x.prototype._setCancellable=function(){this._bitField=this._bitField|67108864},x.prototype._unsetCancellable=function(){this._bitField=this._bitField&-67108865},x.prototype._setIsMigrated=function(){this._bitField=this._bitField|4194304},x.prototype._unsetIsMigrated=function(){this._bitField=this._bitField&-4194305},x.prototype._isMigrated=function(){return(this._bitField&4194304)>0},x.prototype._receiverAt=function(e){var t=e===0?this._receiver0:this[e*5-5+4];return t===o?undefined:t===undefined&&this._isBound()?this._boundValue():t},x.prototype._promiseAt=function(e){return e===0?this._promise0:this[e*5-5+3]},x.prototype._fulfillmentHandlerAt=function(e){return e===0?this._fulfillmentHandler0:this[e*5-5+0]},x.prototype._rejectionHandlerAt=function(e){return e===0?this._rejectionHandler0:this[e*5-5+1]},x.prototype._boundValue=function(){var e=this._boundTo;return e!==undefined&&e instanceof x?e.isFulfilled()?e.value():undefined:e},x.prototype._migrateCallbacks=function(e,t){var n=e._fulfillmentHandlerAt(t),r=e._rejectionHandlerAt(t),i=e._progressHandlerAt(t),s=e._promiseAt(t),u=e._receiverAt(t);s instanceof x&&s._setIsMigrated(),u===undefined&&(u=o),this._addCallbacks(n,r,i,s,u,null)},x.prototype._addCallbacks=function(e,t,n,r,i,s){var o=this._length();o>=131066&&(o=0,this._setLength(0));if(o===0)this._promise0=r,i!==undefined&&(this._receiver0=i),typeof e=="function"&&!this._isCarryingStackTrace()&&(this._fulfillmentHandler0=s===null?e:s.bind(e)),typeof t=="function"&&(this._rejectionHandler0=s===null?t:s.bind(t)),typeof n=="function"&&(this._progressHandler0=s===null?n:s.bind(n));else{var u=o*5-5;this[u+3]=r,this[u+4]=i,typeof e=="function"&&(this[u+0]=s===null?e:s.bind(e)),typeof t=="function"&&(this[u+1]=s===null?t:s.bind(t)),typeof n=="function"&&(this[u+2]=s===null?n:s.bind(n))}return this._setLength(o+1),o},x.prototype._setProxyHandlers=function(e,t){var n=this._length();n>=131066&&(n=0,this._setLength(0));if(n===0)this._promise0=t,this._receiver0=e;else{var r=n*5-5;this[r+3]=t,this[r+4]=e}this._setLength(n+1)},x.prototype._proxyPromiseArray=function(e,t){this._setProxyHandlers(e,t)},x.prototype._resolveCallback=function(e,n){if(this._isFollowingOrFulfilledOrRejected())return;if(e===this)return this._rejectCallback(t(),!1,!0);var r=p(e,this);if(!(r instanceof x))return this._fulfill(e);var i=1|(n?4:0);this._propagateFrom(r,i);var s=r._target();if(s._isPending()){var o=this._length();for(var u=0;u<o;++u)s._migrateCallbacks(this,u);this._setFollowing(),this._setLength(0),this._setFollowee(s)}else s._isFulfilled()?this._fulfillUnchecked(s._value()):this._rejectUnchecked(s._reason(),s._getCarriedStackTrace())},x.prototype._rejectCallback=function(e,t,n){n||i.markAsOriginatingFromRejection(e);var r=i.ensureErrorObject(e),s=r===e;this._attachExtraTrace(r,t?s:!1),this._reject(e,s?undefined:r)},x.prototype._resolveFromResolver=function(e){var t=this;this._captureStackTrace(),this._pushContext();var n=!0,r=S(e)(function(e){if(t===null)return;t._resolveCallback(e),t=null},function(e){if(t===null)return;t._rejectCallback(e,n),t=null});n=!1,this._popContext(),r!==undefined&&r===E&&t!==null&&(t._rejectCallback(r.e,!0,!0),t=null)},x.prototype._settlePromiseFromHandler=function(e,n,r,i){if(i._isRejected())return;i._pushContext();var s;n===c&&!this._isRejected()?s=S(e).apply(this._boundValue(),r):s=S(e).call(n,r),i._popContext();if(s===E||s===i||s===h){var o=s===i?t():s.e;i._rejectCallback(o,!1,!0)}else i._resolveCallback(s)},x.prototype._target=function(){var e=this;while(e._isFollowing())e=e._followee();return e},x.prototype._followee=function(){return this._rejectionHandler0},x.prototype._setFollowee=function(e){this._rejectionHandler0=e},x.prototype._cleanValues=function(){this._cancellable()&&(this._cancellationParent=undefined)},x.prototype._propagateFrom=function(e,t){(t&1)>0&&e._cancellable()&&(this._setCancellable(),this._cancellationParent=e),(t&4)>0&&e._isBound()&&this._setBoundTo(e._boundTo)},x.prototype._fulfill=function(e){if(this._isFollowingOrFulfilledOrRejected())return;this._fulfillUnchecked(e)},x.prototype._reject=function(e,t){if(this._isFollowingOrFulfilledOrRejected())return;this._rejectUnchecked(e,t)},x.prototype._settlePromiseAt=function(e){var t=this._promiseAt(e),n=t instanceof x;if(n&&t._isMigrated())return t._unsetIsMigrated(),u.invoke(this._settlePromiseAt,this,e);var r=this._isFulfilled()?this._fulfillmentHandlerAt(e):this._rejectionHandlerAt(e),i=this._isCarryingStackTrace()?this._getCarriedStackTrace():undefined,s=this._settledValue,o=this._receiverAt(e);this._clearCallbackDataAtIndex(e),typeof r=="function"?n?this._settlePromiseFromHandler(r,o,s,t):r.call(o,s,t):o instanceof d?o._isResolved()||(this._isFulfilled()?o._promiseFulfilled(s,t):o._promiseRejected(s,t)):n&&(this._isFulfilled()?t._fulfill(s):t._reject(s,i)),e>=4&&(e&31)===4&&u.invokeLater(this._setLength,this,0)},x.prototype._clearCallbackDataAtIndex=function(e){if(e===0)this._isCarryingStackTrace()||(this._fulfillmentHandler0=undefined),this._rejectionHandler0=this._progressHandler0=this._receiver0=this._promise0=undefined;else{var t=e*5-5;this[t+3]=this[t+4]=this[t+0]=this[t+1]=this[t+2]=undefined}},x.prototype._isSettlePromisesQueued=function(){return(this._bitField&-1073741824)===-1073741824},x.prototype._setSettlePromisesQueued=function(){this._bitField=this._bitField|-1073741824},x.prototype._unsetSettlePromisesQueued=function(){this._bitField=this._bitField&1073741823},x.prototype._queueSettlePromises=function(){u.settlePromises(this),this._setSettlePromisesQueued()},x.prototype._fulfillUnchecked=function(e){if(e===this){var n=t();return this._attachExtraTrace(n),this._rejectUnchecked(n,undefined)}this._setFulfilled(),this._settledValue=e,this._cleanValues(),this._length()>0&&this._queueSettlePromises()},x.prototype._rejectUncheckedCheckError=function(e){var t=i.ensureErrorObject(e);this._rejectUnchecked(e,t===e?undefined:t)},x.prototype._rejectUnchecked=function(e,n){if(e===this){var r=t();return this._attachExtraTrace(r),this._rejectUnchecked(r)}this._setRejected(),this._settledValue=e,this._cleanValues();if(this._isFinal()){u.throwLater(function(e){throw"stack"in e&&u.invokeFirst(v.unhandledRejection,undefined,e),e},n===undefined?e:n);return}n!==undefined&&n!==e&&this._setCarriedStackTrace(n),this._length()>0?this._queueSettlePromises():this._ensurePossibleRejectionHandled()},x.prototype._settlePromises=function(){this._unsetSettlePromisesQueued();var e=this._length();for(var t=0;t<e;t++)this._settlePromiseAt(t)},i.notEnumerableProp(x,"_makeSelfResolutionError",t),e("./progress.js")(x,d),e("./method.js")(x,l,p,r),e("./bind.js")(x,l,p),e("./finally.js")(x,h,p),e("./direct_resolve.js")(x),e("./synchronous_inspection.js")(x),e("./join.js")(x,d,p,l),x.Promise=x,e("./map.js")(x,d,r,p,l),e("./cancel.js")(x),e("./using.js")(x,r,p,g),e("./generators.js")(x,r,l,p),e("./nodeify.js")(x),e("./call_get.js")(x),e("./props.js")(x,d,p,r),e("./race.js")(x,l,p,r),e("./reduce.js")(x,d,r,p,l),e("./settle.js")(x,d),e("./some.js")(x,d,r),e("./promisify.js")(x,l),e("./any.js")(x),e("./each.js")(x,l),e("./timers.js")(x,l),e("./filter.js")(x,l),i.toFastProperties(x),i.toFastProperties(x.prototype),T({a:1}),T({b:2}),T({c:3}),T(1),T(function(){}),T(undefined),T(!1),T(new x(l)),v.setBounds(u.firstLineError,i.lastLineError),x}},{"./any.js":1,"./async.js":2,"./bind.js":3,"./call_get.js":5,"./cancel.js":6,"./captured_trace.js":7,"./catch_filter.js":8,"./context.js":9,"./debuggability.js":10,"./direct_resolve.js":11,"./each.js":12,"./errors.js":13,"./filter.js":15,"./finally.js":16,"./generators.js":17,"./join.js":18,"./map.js":19,"./method.js":20,"./nodeify.js":21,"./progress.js":22,"./promise_array.js":24,"./promise_resolver.js":25,"./promisify.js":26,"./props.js":27,"./race.js":29,"./reduce.js":30,"./settle.js":32,"./some.js":33,"./synchronous_inspection.js":34,"./thenables.js":35,"./timers.js":36,"./using.js":37,"./util.js":38}],24:[function(e,t,n){"use strict";t.exports=function(t,n,r,i){function u(e){switch(e){case-2:return[];case-3:return{}}}function a(e){var r=this._promise=new t(n),i;e instanceof t&&(i=e,r._propagateFrom(i,5)),this._values=e,this._length=0,this._totalResolved=0,this._init(undefined,-2)}var s=e("./util.js"),o=s.isArray;return a.prototype.length=function(){return this._length},a.prototype.promise=function(){return this._promise},a.prototype._init=function f(e,n){var s=r(this._values,this._promise);if(s instanceof t){s=s._target(),this._values=s;if(!s._isFulfilled()){if(s._isPending()){s._then(f,this._reject,undefined,this,n);return}this._reject(s._reason());return}s=s._value();if(!o(s)){var a=new t.TypeError("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");this.__hardReject__(a);return}}else if(!o(s)){this._promise._reject(i("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n")._reason());return}if(s.length===0){n===-5?this._resolveEmptyArray():this._resolve(u(n));return}var l=this.getActualLength(s.length);this._length=l,this._values=this.shouldCopyValues()?new Array(l):this._values;var c=this._promise;for(var h=0;h<l;++h){var p=this._isResolved(),d=r(s[h],c);d instanceof t?(d=d._target(),p?d._ignoreRejections():d._isPending()?d._proxyPromiseArray(this,h):d._isFulfilled()?this._promiseFulfilled(d._value(),h):this._promiseRejected(d._reason(),h)):p||this._promiseFulfilled(d,h)}},a.prototype._isResolved=function(){return this._values===null},a.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},a.prototype.__hardReject__=a.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1,!0)},a.prototype._promiseProgressed=function(e,t){this._promise._progress({index:t,value:e})},a.prototype._promiseFulfilled=function(e,t){this._values[t]=e;var n=++this._totalResolved;n>=this._length&&this._resolve(this._values)},a.prototype._promiseRejected=function(e,t){this._totalResolved++,this._reject(e)},a.prototype.shouldCopyValues=function(){return!0},a.prototype.getActualLength=function(e){return e},a}},{"./util.js":38}],25:[function(e,t,n){"use strict";function l(e){return e instanceof Error&&f.getPrototypeOf(e)===Error.prototype}function h(e){var t;if(l(e)){t=new u(e),t.name=e.name,t.message=e.message,t.stack=e.stack;var n=f.keys(e);for(var i=0;i<n.length;++i){var s=n[i];c.test(s)||(t[s]=e[s])}return t}return r.markAsOriginatingFromRejection(e),e}function p(e){return function(t,n){if(e===null)return;if(t){var r=h(i(t));e._attachExtraTrace(r),e._reject(r)}else if(arguments.length>2){var s=arguments.length,o=new Array(s-1);for(var u=1;u<s;++u)o[u-1]=arguments[u];e._fulfill(o)}else e._fulfill(n);e=null}}var r=e("./util.js"),i=r.maybeWrapAsError,s=e("./errors.js"),o=s.TimeoutError,u=s.OperationalError,a=r.haveGetters,f=e("./es5.js"),c=/^(?:name|message|stack|cause)$/,d;a?d=function(e){this.promise=e}:d=function(e){this.promise=e,this.asCallback=p(e),this.callback=this.asCallback};if(a){var v={get:function(){return p(this.promise)}};f.defineProperty(d.prototype,"asCallback",v),f.defineProperty(d.prototype,"callback",v)}d._nodebackForPromise=p,d.prototype.toString=function(){return"[object PromiseResolver]"},d.prototype.resolve=d.prototype.fulfill=function(e){if(!(this instanceof d))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._resolveCallback(e)},d.prototype.reject=function(e){if(!(this instanceof d))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._rejectCallback(e)},d.prototype.progress=function(e){if(!(this instanceof d))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._progress(e)},d.prototype.cancel=function(e){this.promise.cancel(e)},d.prototype.timeout=function(){this.reject(new o("timeout"))},d.prototype.isResolved=function(){return this.promise.isResolved()},d.prototype.toJSON=function(){return this.promise.toJSON()},t.exports=d},{"./errors.js":13,"./es5.js":14,"./util.js":38}],26:[function(e,t,n){"use strict";t.exports=function(t,n){function v(e){return!p.test(e)}function m(e){try{return e.__isPromisified__===!0}catch(t){return!1}}function g(e,t,n){var r=i.getDataPropertyOrDefault(e,t+n,c);return r?m(r):!1}function y(e,t,n){for(var r=0;r<e.length;r+=2){var i=e[r];if(n.test(i)){var s=i.replace(n,"");for(var o=0;o<e.length;o+=2)if(e[o]===s)throw new f("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/iWrZbw\n".replace("%s",t))}}}function b(e,t,n,r){var s=i.inheritedDataKeys(e),o=[];for(var u=0;u<s.length;++u){var a=s[u],f=e[a],l=r===d?!0:d(a,f,e);typeof f=="function"&&!m(f)&&!g(e,a,t)&&r(a,f,e,l)&&o.push(a,f)}return y(o,t,n),o}function C(e,a,f,l){function p(){var i=a;a===r&&(i=this);var f=new t(n);f._captureStackTrace();var l=typeof h=="string"&&this!==c?this[h]:e,p=s(f);try{l.apply(i,o(arguments,p))}catch(d){f._rejectCallback(u(d),!0,!0)}return f}var c=function(){return this}(),h=e;return typeof h=="string"&&(e=l),i.notEnumerableProp(p,"__isPromisified__",!0),p}function L(e,t,n,s){var o=new RegExp(w(t)+"$"),u=b(e,t,o,n);for(var a=0,f=u.length;a<f;a+=2){var l=u[a],c=u[a+1],h=l+t;if(s===k)e[h]=k(l,r,l,c,t);else{var p=s(c,function(){return k(l,r,l,c,t)});i.notEnumerableProp(p,"__isPromisified__",!0),e[h]=p}}return i.toFastProperties(e),e}function A(e,t){return k(e,t,undefined,e)}var r={},i=e("./util.js"),s=e("./promise_resolver.js")._nodebackForPromise,o=i.withAppended,u=i.maybeWrapAsError,a=i.canEvaluate,f=e("./errors").TypeError,l="Async",c={__isPromisified__:!0},h=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],p=new RegExp("^(?:"+h.join("|")+")$"),d=function(e){return i.isIdentifier(e)&&e.charAt(0)!=="_"&&e!=="constructor"},w=function(e){return e.replace(/([$])/,"\\$")},E,k=a?E:C;t.promisify=function(e,t){if(typeof e!="function")throw new f("fn must be a function\n\n    See http://goo.gl/916lJJ\n");if(m(e))return e;var n=A(e,arguments.length<2?r:t);return i.copyDescriptors(e,n,v),n},t.promisifyAll=function(e,t){if(typeof e!="function"&&typeof e!="object")throw new f("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/9ITlV0\n");t=Object(t);var n=t.suffix;typeof n!="string"&&(n=l);var r=t.filter;typeof r!="function"&&(r=d);var s=t.promisifier;typeof s!="function"&&(s=k);if(!i.isIdentifier(n))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/8FZo5V\n");var o=i.inheritedDataKeys(e);for(var u=0;u<o.length;++u){var a=e[o[u]];o[u]!=="constructor"&&i.isClass(a)&&(L(a.prototype,n,r,s),L(a,n,r,s))}return L(e,n,r,s)}}},{"./errors":13,"./promise_resolver.js":25,"./util.js":38}],27:[function(e,t,n){"use strict";t.exports=function(t,n,r,i){function a(e){var t=u.keys(e),n=t.length,r=new Array(n*2);for(var i=0;i<n;++i){var s=t[i];r[i]=e[s],r[i+n]=s}this.constructor$(r)}function f(e){var n,s=r(e);return o(s)?(s instanceof t?n=s._then(t.props,undefined,undefined,undefined,undefined):n=(new a(s)).promise(),s instanceof t&&n._propagateFrom(s,4),n):i("cannot await properties of a non-object\n\n    See http://goo.gl/OsFKC8\n")}var s=e("./util.js"),o=s.isObject,u=e("./es5.js");s.inherits(a,n),a.prototype._init=function(){this._init$(undefined,-3)},a.prototype._promiseFulfilled=function(e,t){this._values[t]=e;var n=++this._totalResolved;if(n>=this._length){var r={},i=this.length();for(var s=0,o=this.length();s<o;++s)r[this._values[s+i]]=this._values[s];this._resolve(r)}},a.prototype._promiseProgressed=function(e,t){this._promise._progress({key:this._values[t+this.length()],value:e})},a.prototype.shouldCopyValues=function(){return!1},a.prototype.getActualLength=function(e){return e>>1},t.prototype.props=function(){return f(this)},t.props=function(e){return f(e)}}},{"./es5.js":14,"./util.js":38}],28:[function(e,t,n){"use strict";function r(e,t,n,r,i){for(var s=0;s<i;++s)n[s+r]=e[s+t],e[s+t]=void 0}function i(e){this._capacity=e,this._length=0,this._front=0}i.prototype._willBeOverCapacity=function(e){return this._capacity<e},i.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1);var n=this._front+t&this._capacity-1;this[n]=e,this._length=t+1},i.prototype._unshiftOne=function(e){var t=this._capacity;this._checkCapacity(this.length()+1);var n=this._front,r=(n-1&t-1^t)-t;this[r]=e,this._front=r,this._length=this.length()+1},i.prototype.unshift=function(e,t,n){this._unshiftOne(n),this._unshiftOne(t),this._unshiftOne(e)},i.prototype.push=function(e,t,n){var r=this.length()+3;if(this._willBeOverCapacity(r)){this._pushOne(e),this._pushOne(t),this._pushOne(n);return}var i=this._front+r-3;this._checkCapacity(r);var s=this._capacity-1;this[i+0&s]=e,this[i+1&s]=t,this[i+2&s]=n,this._length=r},i.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=undefined,this._front=e+1&this._capacity-1,this._length--,t},i.prototype.length=function(){return this._length},i.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},i.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e;var n=this._front,i=this._length,s=n+i&t-1;r(this,0,this,t,s)},t.exports=i},{}],29:[function(e,t,n){"use strict";t.exports=function(t,n,r,i){function u(e,u){var a=r(e);if(a instanceof t)return o(a);if(!s(e))return i("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");var f=new t(n);u!==undefined&&f._propagateFrom(u,5);var l=f._fulfill,c=f._reject;for(var h=0,p=e.length;h<p;++h){var d=e[h];if(!(d!==undefined||h in e))continue;t.cast(d)._then(l,c,undefined,f,null)}return f}var s=e("./util.js").isArray,o=function(e){return e.then(function(t){return u(t,e)})};t.race=function(e){return u(e,undefined)},t.prototype.race=function(){return u(this,undefined)}}},{"./util.js":38}],30:[function(e,t,n){"use strict";t.exports=function(t,n,r,i,s){function c(e,n,r,a){this.constructor$(e),this._promise._captureStackTrace(),this._preservedValues=a===s?[]:null,this._zerothIsAccum=r===undefined,this._gotAccum=!1,this._reducingIndex=this._zerothIsAccum?1:0,this._valuesPhase=undefined;var f=i(r,this._promise),l=!1,c=f instanceof t;c&&(f=f._target(),f._isPending()?f._proxyPromiseArray(this,-1):f._isFulfilled()?(r=f._value(),this._gotAccum=!0):(this._reject(f._reason()),l=!0)),!c&&!this._zerothIsAccum&&(this._gotAccum=!0);var p=o();this._callback=p===null?n:p.bind(n),this._accum=r,l||u.invoke(h,this,undefined)}function h(){this._init$(undefined,-5)}function p(e,t,n,i){if(typeof t!="function")return r("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var s=new c(e,t,n,i);return s.promise()}var o=t._getDomain,u=e("./async.js"),a=e("./util.js"),f=a.tryCatch,l=a.errorObj;a.inherits(c,n),c.prototype._init=function(){},c.prototype._resolveEmptyArray=function(){(this._gotAccum||this._zerothIsAccum)&&this._resolve(this._preservedValues!==null?[]:this._accum)},c.prototype._promiseFulfilled=function(e,n){var r=this._values;r[n]=e;var s=this.length(),o=this._preservedValues,u=o!==null,a=this._gotAccum,c=this._valuesPhase,h;if(!c){c=this._valuesPhase=new Array(s);for(h=0;h<s;++h)c[h]=0}h=c[n],n===0&&this._zerothIsAccum?(this._accum=e,this._gotAccum=a=!0,c[n]=h===0?1:2):n===-1?(this._accum=e,this._gotAccum=a=!0):h===0?c[n]=1:(c[n]=2,this._accum=e);if(!a)return;var p=this._callback,d=this._promise._boundValue(),v;for(var m=this._reducingIndex;m<s;++m){h=c[m];if(h===2){this._reducingIndex=m+1;continue}if(h!==1)return;e=r[m],this._promise._pushContext(),u?(o.push(e),v=f(p).call(d,e,m,s)):v=f(p).call(d,this._accum,e,m,s),this._promise._popContext();if(v===l)return this._reject(v.e);var g=i(v,this._promise);if(g instanceof t){g=g._target();if(g._isPending())return c[m]=4,g._proxyPromiseArray(this,m);if(!g._isFulfilled())return this._reject(g._reason());v=g._value()}this._reducingIndex=m+1,this._accum=v}this._resolve(u?o:this._accum)},t.prototype.reduce=function(e,t){return p(this,e,t,null)},t.reduce=function(e,t,n,r){return p(e,t,n,r)}}},{"./async.js":2,"./util.js":38}],31:[function(e,t,n){"use strict";var r,i=e("./util"),s=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")};if(i.isNode&&typeof MutationObserver=="undefined"){var o=global.setImmediate,u=process.nextTick;r=i.isRecentNode?function(e){o.call(global,e)}:function(e){u.call(process,e)}}else typeof MutationObserver!="undefined"&&(typeof window=="undefined"||!window.navigator||!window.navigator.standalone)?(r=function(e){var t=document.createElement("div"),n=new MutationObserver(e);return n.observe(t,{attributes:!0}),function(){t.classList.toggle("foo")}},r.isStatic=!0):typeof setImmediate!="undefined"?r=function(e){setImmediate(e)}:typeof setTimeout!="undefined"?r=function(e){setTimeout(e,0)}:r=s;t.exports=r},{"./util":38}],32:[function(e,t,n){"use strict";t.exports=function(t,n){function s(e){this.constructor$(e)}var r=t.PromiseInspection,i=e("./util.js");i.inherits(s,n),s.prototype._promiseResolved=function(e,t){this._values[e]=t;var n=++this._totalResolved;n>=this._length&&this._resolve(this._values)},s.prototype._promiseFulfilled=function(e,t){var n=new r;n._bitField=268435456,n._settledValue=e,this._promiseResolved(t,n)},s.prototype._promiseRejected=function(e,t){var n=new r;n._bitField=134217728,n._settledValue=e,this._promiseResolved(t,n)},t.settle=function(e){return(new s(e)).promise()},t.prototype.settle=function(){return(new s(this)).promise()}}},{"./util.js":38}],33:[function(e,t,n){"use strict";t.exports=function(t,n,r){function a(e){this.constructor$(e),this._howMany=0,this._unwrap=!1,this._initialized=!1}function f(e,t){if((t|0)!==t||t<0)return r("expecting a positive integer\n\n    See http://goo.gl/1wAmHx\n");var n=new a(e),i=n.promise();return n.setHowMany(t),n.init(),i}var i=e("./util.js"),s=e("./errors.js").RangeError,o=e("./errors.js").AggregateError,u=i.isArray;i.inherits(a,n),a.prototype._init=function(){if(!this._initialized)return;if(this._howMany===0){this._resolve([]);return}this._init$(undefined,-5);var e=u(this._values);!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))},a.prototype.init=function(){this._initialized=!0,this._init()},a.prototype.setUnwrap=function(){this._unwrap=!0},a.prototype.howMany=function(){return this._howMany},a.prototype.setHowMany=function(e){this._howMany=e},a.prototype._promiseFulfilled=function(e){this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),this.howMany()===1&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values))},a.prototype._promiseRejected=function(e){this._addRejected(e);if(this.howMany()>this._canPossiblyFulfill()){var t=new o;for(var n=this.length();n<this._values.length;++n)t.push(this._values[n]);this._reject(t)}},a.prototype._fulfilled=function(){return this._totalResolved},a.prototype._rejected=function(){return this._values.length-this.length()},a.prototype._addRejected=function(e){this._values.push(e)},a.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},a.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},a.prototype._getRangeError=function(e){var t="Input array must contain at least "+this._howMany+" items but contains only "+e+" items";return new s(t)},a.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(e,t){return f(e,t)},t.prototype.some=function(e){return f(this,e)},t._SomePromiseArray=a}},{"./errors.js":13,"./util.js":38}],34:[function(e,t,n){"use strict";t.exports=function(e){function t(e){e!==undefined?(e=e._target(),this._bitField=e._bitField,this._settledValue=e._settledValue):(this._bitField=0,this._settledValue=undefined)}t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");return this._settledValue},t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");return this._settledValue},t.prototype.isFulfilled=e.prototype._isFulfilled=function(){return(this._bitField&268435456)>0},t.prototype.isRejected=e.prototype._isRejected=function(){return(this._bitField&134217728)>0},t.prototype.isPending=e.prototype._isPending=function(){return(this._bitField&402653184)===0},t.prototype.isResolved=e.prototype._isResolved=function(){return(this._bitField&402653184)>0},e.prototype.isPending=function(){return this._target()._isPending()},e.prototype.isRejected=function(){return this._target()._isRejected()},e.prototype.isFulfilled=function(){return this._target()._isFulfilled()},e.prototype.isResolved=function(){return this._target()._isResolved()},e.prototype._value=function(){return this._settledValue},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue},e.prototype.value=function(){var e=this._target();if(!e.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");return e._settledValue},e.prototype.reason=function(){var e=this._target();if(!e.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");return e._unsetRejectionIsUnhandled(),e._settledValue},e.PromiseInspection=t}},{}],35:[function(e,t,n){"use strict";t.exports=function(t,n){function o(e,o){if(s(e)){if(e instanceof t)return e;if(f(e)){var a=new t(n);return e._then(a._fulfillUnchecked,a._rejectUncheckedCheckError,a._progressUnchecked,a,null),a}var c=r.tryCatch(u)(e);if(c===i){o&&o._pushContext();var a=t.reject(c.e);return o&&o._popContext(),a}if(typeof c=="function")return l(e,c,o)}return e}function u(e){return e.then}function f(e){return a.call(e,"_promise0")}function l(e,s,o){function c(e){if(!u)return;u._resolveCallback(e),u=null}function h(e){if(!u)return;u._rejectCallback(e,f,!0),u=null}function p(e){if(!u)return;typeof u._progress=="function"&&u._progress(e)}var u=new t(n),a=u;o&&o._pushContext(),u._captureStackTrace(),o&&o._popContext();var f=!0,l=r.tryCatch(s).call(e,c,h,p);return f=!1,u&&l===i&&(u._rejectCallback(l.e,!0,!0),u=null),a}var r=e("./util.js"),i=r.errorObj,s=r.isObject,a={}.hasOwnProperty;return o}},{"./util.js":38}],36:[function(e,t,n){"use strict";t.exports=function(t,n){function a(e){var t=this;return t instanceof Number&&(t=+t),clearTimeout(t),e}function f(e){var t=this;throw t instanceof Number&&(t=+t),clearTimeout(t),e}var r=e("./util.js"),i=t.TimeoutError,s=function(e,t){if(!e.isPending())return;var n;!r.isPrimitive(t)&&t instanceof Error?n=t:(typeof t!="string"&&(t="operation timed out"),n=new i(t)),r.markAsOriginatingFromRejection(n),e._attachExtraTrace(n),e._cancel(n)},o=function(e){return u(+this).thenReturn(e)},u=t.delay=function(e,r){if(r===undefined){r=e,e=undefined;var i=new t(n);return setTimeout(function(){i._fulfill()},r),i}return r=+r,t.resolve(e)._then(o,null,null,r,undefined)};t.prototype.delay=function(e){return u(this,e)},t.prototype.timeout=function(e,t){e=+e;var n=this.then().cancellable();n._cancellationParent=this;var r=setTimeout(function(){s(n,t)},e);return n._then(a,f,undefined,r,undefined)}}},{"./util.js":38}],37:[function(e,t,n){"use strict";t.exports=function(t,n,r,i){function a(e){var n=e.length;for(var r=0;r<n;++r){var i=e[r];if(i.isRejected())return t.reject(i.error());e[r]=i._settledValue}return e}function f(e){setTimeout(function(){throw e},0)}function l(e){var t=r(e);return t!==e&&typeof e._isDisposable=="function"&&typeof e._getDisposer=="function"&&e._isDisposable()&&t._setDisposable(e._getDisposer()),t}function c(e,n){function u(){if(i>=s)return o.resolve();var a=l(e[i++]);if(a instanceof t&&a._isDisposable()){try{a=r(a._getDisposer().tryDispose(n),e.promise)}catch(c){return f(c)}if(a instanceof t)return a._then(u,f,null,null,null)}u()}var i=0,s=e.length,o=t.defer();return u(),o.promise}function h(e){var t=new u;return t._settledValue=e,t._bitField=268435456,c(this,t).thenReturn(e)}function p(e){var t=new u;return t._settledValue=e,t._bitField=134217728,c(this,t).thenThrow(e)}function d(e,t,n){this._data=e,this._promise=t,this._context=n}function v(e,t,n){this.constructor$(e,t,n)}function m(e){return d.isDisposer(e)?(this.resources[this.index]._setDisposable(e),e.promise()):e}var s=e("./errors.js").TypeError,o=e("./util.js").inherits,u=t.PromiseInspection;d.prototype.data=function(){return this._data},d.prototype.promise=function(){return this._promise},d.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():null},d.prototype.tryDispose=function(e){var t=this.resource(),n=this._context;n!==undefined&&n._pushContext();var r=t!==null?this.doDispose(t,e):null;return n!==undefined&&n._popContext(),this._promise._unsetDisposable(),this._data=null,r},d.isDisposer=function(e){return e!=null&&typeof e.resource=="function"&&typeof e.tryDispose=="function"},o(v,d),v.prototype.doDispose=function(e,t){var n=this.data();return n.call(e,e,t)},t.using=function(){var e=arguments.length;if(e<2)return n("you must pass at least 2 arguments to Promise.using");var i=arguments[e-1];if(typeof i!="function")return n("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var s,o=!0;e===2&&Array.isArray(arguments[0])?(s=arguments[0],e=s.length,o=!1):(s=arguments,e--);var u=new Array(e);for(var f=0;f<e;++f){var l=s[f];if(d.isDisposer(l)){var c=l;l=l.promise(),l._setDisposable(c)}else{var v=r(l);v instanceof t&&(l=v._then(m,null,null,{resources:u,index:f},undefined))}u[f]=l}var g=t.settle(u).then(a).then(function(e){g._pushContext();var t;try{t=o?i.apply(undefined,e):i.call(undefined,e)}finally{g._popContext()}return t})._then(h,p,undefined,u,undefined);return u.promise=g,g},t.prototype._setDisposable=function(e){this._bitField=this._bitField|262144,this._disposer=e},t.prototype._isDisposable=function(){return(this._bitField&262144)>0},t.prototype._getDisposer=function(){return this._disposer},t.prototype._unsetDisposable=function(){this._bitField=this._bitField&-262145,this._disposer=undefined},t.prototype.disposer=function(e){if(typeof e=="function")return new v(e,this,i());throw new s}}},{"./errors.js":13,"./util.js":38}],38:[function(_dereq_,module,exports){"use strict";function tryCatcher(){try{var e=tryCatchTarget;return tryCatchTarget=null,e.apply(this,arguments)}catch(t){return errorObj.e=t,errorObj}}function tryCatch(e){return tryCatchTarget=e,tryCatcher}function isPrimitive(e){return e==null||e===!0||e===!1||typeof e=="string"||typeof e=="number"}function isObject(e){return!isPrimitive(e)}function maybeWrapAsError(e){return isPrimitive(e)?new Error(safeToString(e)):e}function withAppended(e,t){var n=e.length,r=new Array(n+1),i;for(i=0;i<n;++i)r[i]=e[i];return r[i]=t,r}function getDataPropertyOrDefault(e,t,n){if(!es5.isES5)return{}.hasOwnProperty.call(e,t)?e[t]:undefined;var r=Object.getOwnPropertyDescriptor(e,t);if(r!=null)return r.get==null&&r.set==null?r.value:n}function notEnumerableProp(e,t,n){if(isPrimitive(e))return e;var r={value:n,configurable:!0,enumerable:!1,writable:!0};return es5.defineProperty(e,t,r),e}function thrower(e){throw e}function isClass(e){try{if(typeof e=="function"){var t=es5.names(e.prototype),n=es5.isES5&&t.length>1,r=t.length>0&&(t.length!==1||t[0]!=="constructor"),i=thisAssignmentPattern.test(e+"")&&es5.names(e).length>0;if(n||r||i)return!0}return!1}catch(s){return!1}}function toFastProperties(obj){function f(){}f.prototype=obj;var l=8;while(l--)new f;return obj}function isIdentifier(e){return rident.test(e)}function filledRange(e,t,n){var r=new Array(e);for(var i=0;i<e;++i)r[i]=t+i+n;return r}function safeToString(e){try{return e+""}catch(t){return"[no string representation]"}}function markAsOriginatingFromRejection(e){try{notEnumerableProp(e,"isOperational",!0)}catch(t){}}function originatesFromRejection(e){return e==null?!1:e instanceof Error.__BluebirdErrorTypes__.OperationalError||e.isOperational===!0}function canAttachTrace(e){return e instanceof Error&&es5.propertyIsWritable(e,"stack")}function classString(e){return{}.toString.call(e)}function copyDescriptors(e,t,n){var r=es5.names(e);for(var i=0;i<r.length;++i){var s=r[i];if(n(s))try{es5.defineProperty(t,s,es5.getDescriptor(e,s))}catch(o){}}}var es5=_dereq_("./es5.js"),canEvaluate=typeof navigator=="undefined",haveGetters=function(){try{var e={};return es5.defineProperty(e,"f",{get:function(){return 3}}),e.f===3}catch(t){return!1}}(),errorObj={e:{}},tryCatchTarget,inherits=function(e,t){function r(){this.constructor=e,this.constructor$=t;for(var r in t.prototype)n.call(t.prototype,r)&&r.charAt(r.length-1)!=="$"&&(this[r+"$"]=t.prototype[r])}var n={}.hasOwnProperty;return r.prototype=t.prototype,e.prototype=new r,e.prototype},inheritedDataKeys=function(){var e=[Array.prototype,Object.prototype,Function.prototype],t=function(t){for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1};if(es5.isES5){var n=Object.getOwnPropertyNames;return function(e){var r=[],i=Object.create(null);while(e!=null&&!t(e)){var s;try{s=n(e)}catch(o){return r}for(var u=0;u<s.length;++u){var a=s[u];if(i[a])continue;i[a]=!0;var f=Object.getOwnPropertyDescriptor(e,a);f!=null&&f.get==null&&f.set==null&&r.push(a)}e=es5.getPrototypeOf(e)}return r}}var r={}.hasOwnProperty;return function(n){if(t(n))return[];var i=[];e:for(var s in n)if(r.call(n,s))i.push(s);else{for(var o=0;o<e.length;++o)if(r.call(e[o],s))continue e;i.push(s)}return i}}(),thisAssignmentPattern=/this\s*\.\s*\S+\s*=/,rident=/^[a-z$_][a-z$_0-9]*$/i,ensureErrorObject=function(){return"stack"in new Error?function(e){return canAttachTrace(e)?e:new Error(safeToString(e))}:function(e){if(canAttachTrace(e))return e;try{throw new Error(safeToString(e))}catch(t){return t}}}(),ret={isClass:isClass,isIdentifier:isIdentifier,inheritedDataKeys:inheritedDataKeys,getDataPropertyOrDefault:getDataPropertyOrDefault,thrower:thrower,isArray:es5.isArray,haveGetters:haveGetters,notEnumerableProp:notEnumerableProp,isPrimitive:isPrimitive,isObject:isObject,canEvaluate:canEvaluate,errorObj:errorObj,tryCatch:tryCatch,inherits:inherits,withAppended:withAppended,maybeWrapAsError:maybeWrapAsError,toFastProperties:toFastProperties,filledRange:filledRange,toString:safeToString,canAttachTrace:canAttachTrace,ensureErrorObject:ensureErrorObject,originatesFromRejection:originatesFromRejection,markAsOriginatingFromRejection:markAsOriginatingFromRejection,classString:classString,copyDescriptors:copyDescriptors,hasDevTools:typeof chrome!="undefined"&&chrome&&typeof chrome.loadTimes=="function",isNode:typeof process!="undefined"&&classString(process).toLowerCase()==="[object process]"};ret.isRecentNode=ret.isNode&&function(){var e=process.versions.node.split(".").map(Number);return e[0]===0&&e[1]>10||e[0]>0}(),ret.isNode&&ret.toFastProperties(process);try{throw new Error}catch(e){ret.lastLineError=e}module.exports=ret},{"./es5.js":14}]},{},[4])(4)}),typeof window!="undefined"&&window!==null?window.P=window.Promise:typeof self!="undefined"&&self!==null&&(self.P=self.Promise),define("back4app-entity/adapters/Adapter",["require","exports","module","chai","bluebird"],function(e,t,n){"use strict";function s(){r(this).to.be.an("object","The Adapter's constructor can be only invoked from specializedclasses' constructors"),r(this.constructor).to.be.a("function","The Adapter's constructor can be only invoked from specializedclasses' constructors"),r(this.constructor).to.not.equal(s,"The Adapter is an abstract class and cannot be directly initialized"),r(this).to.be.instanceof(s,"The Adapter's constructor can be only invoked from specializedclasses' constructors")}function o(){throw new Error('Function "loadEntity" has to be implemented in the Adapter specialization')}function u(){throw new Error('Function "loadAttribute" has to be implemented in the Adapter specialization')}function a(){return new i(function(){throw new Error('Function "insertObject" has to be implemented in the Adapter specialization')})}function f(){return new i(function(){throw new Error('Function "updateObject" has to be implemented in the Adapter specialization')})}var r=e("chai").expect,i=e("bluebird");n.exports=s,s.prototype.loadEntity=o,s.prototype.loadEntityAttribute=u,s.prototype.insertObject=a,s.prototype.updateObject=f}),define("back4app-entity/models/errors",["require","exports","module","util","chai"],function(e,t,n){function s(e,t){this.entity=e,this.innerError=t,i(arguments).to.have.length.below(3,"Invalid arguments length when creating a new EntityNotFoundError (it has to be passed less than 3 arguments)"),this.name="EntityNotFoundError",this.message="Cannot find Entity",e&&(i(e).to.be.a("string",'Invalid argument "entity" when creating a new EntityNotFoundError (it has to be a string)'),this.message+=' "'+e+'"'),this.stack=(new Error(this.message)).stack,t&&(i(t).to.be.an.instanceof(Error,'Invalid argument "innerError" when creating a new EntityNotFoundError (it has to be an Error)'),this.stack+="\n\n"+t.stack)}function o(e,t){this.type=e,this.innerError=t,i(arguments).to.have.length.below(3,"Invalid arguments length when creating a new AttributeTypeNotFoundError (it has to be passed less than 3 arguments)"),this.name="AttributeTypeNotFoundError",this.message="Cannot find Attribute type",e&&(i(e).to.be.a("string",'Invalid argument "type" when creating a new AttributeTypeNotFoundError (it has to be a string)'),this.message+=' "'+e+'"'),this.stack=(new Error(this.message)).stack,t&&(i(t).to.be.an.instanceof(Error,'Invalid argument "innerError" when creating a new AttributeTypeNotFoundError (it has to be an Error)'),this.stack+="\n\n"+t.stack)}function u(e,t,n){this.entity=e,this.attribute=t,this.innerError=n,i(arguments).to.have.length.below(4,"Invalid arguments length when creating a new NotFetchedError (it has to be passed less than 4 arguments)"),this.name="NotFetchedError",this.message="Error when getting an attribute",t&&(i(t).to.be.a("string",'Invalid argument "attribute" when creating a new ValidationError (it has to be a string)'),this.message+=' called "'+t+'"'),this.message+=" of an entity",e&&(i(e).to.be.a("string",'Invalid argument "entity" when creating a new ValidationError (it has to be a string)'),this.message+=' called "'+e+'"'),this.message+=": this attribute was not fetched yet",this.stack=(new Error(this.message)).stack,n&&(i(n).to.be.an.instanceof(Error,'Invalid argument "innerError" when creating a new ValidationError (it has to be an Error)'),this.stack+="\n\n"+n.stack)}function a(e,t,n,r,s){this.validationMessage=e,this.entity=t,this.attribute=n,this.position=r,this.innerError=s,i(arguments).to.have.length.below(6,"Invalid arguments length when creating a new AttributeTypeNotFoundError (it has to be passed less than 6 arguments)"),this.name="ValidationError",this.message="Error when validating an attribute",n&&(i(n).to.be.a("string",'Invalid argument "attribute" when creating a new ValidationError (it has to be a string)'),this.message+=' called "'+n+'"'),this.message+=" of an entity",t&&(i(t).to.be.a("string",'Invalid argument "entity" when creating a new ValidationError (it has to be a string)'),this.message+=' called "'+t+'"'),r&&(i(["string","number"]).to.include(typeof r,'Invalid argument "position" when creating a new ValidationError (it has to be a string or a number)'),this.message+=" in position "+r),e&&(i(e).to.be.a("string",'Invalid argument "validationMessage" when creating a new ValidationError (it has to be a string)'),this.message+=": "+e),this.stack=(new Error(this.message)).stack,s&&(i(s).to.be.an.instanceof(Error,'Invalid argument "innerError" when creating a new ValidationError (it has to be an Error)'),this.stack+="\n\n"+s.stack)}function f(e,t){this.adapterName=e,this.innerError=t,i(arguments).to.have.length.below(3,"Invalid arguments length when creating a new EntityNotFoundError (it has to be passed less than 3 arguments)"),this.name="AdapterNotFoundError",this.message="Cannot find Adapter",e&&(i(e).to.be.a("string",'Invalid argument "adapterName" when creating a new AdapterNotFoundError (it has to be a string)'),this.message+=' "'+e+'"'),this.stack=(new Error(this.message)).stack,t&&(i(t).to.be.an.instanceof(Error,'Invalid argument "innerError" when creating a new AdapterNotFoundError (it has to be an Error)'),this.stack+="\n\n"+t.stack)}var r=e("util"),i=e("chai").expect;n.exports={},n.exports.EntityNotFoundError=s,n.exports.AttributeTypeNotFoundError=o,n.exports.ValidationError=a,n.exports.AdapterNotFoundError=f,n.exports.NotFetchedError=u,r.inherits(s,Error),r.inherits(o,Error),r.inherits(u,Error),r.inherits(a,Error),r.inherits(f,Error)}),define("back4app-entity/models/attributes/Attribute",["require","exports","module","chai","../../utils/objects","../errors","../index","./index"],function(e,t,n){function f(){this.name=null,this.type=null,this.multiplicity=null,this.default=null,this.dataName=null,r(this).to.be.an("object","The Attribute's constructor can be only invoked from specializedclasses' constructors"),r(this.constructor).to.be.a("function","The Attribute's constructor can be only invoked from specializedclasses' constructors"),r(this.constructor).to.not.equal(f,"The Attribute is an abstract class and cannot be directly initialized"),r(this).to.be.instanceof(f,"The Attribute's constructor can be only invoked from specializedclasses' constructors");var e=null,t=this.constructor,n="1",i=null,s=null,o=null;r(arguments).to.have.length.within(1,4,"Invalid arguments length when creating an Attribute (it has to be passed from 1 to 4 arguments)");if(arguments.length===1&&typeof arguments[0]!="string"){var u=arguments[0];r(u).to.be.an("object","Invalid argument type when creating an Attribute (it has to be an object or a string)"),r(u).to.have.ownProperty("name",'Property "name" is required when creating an Attribute'),r(u.name).to.be.a("string",'Invalid property "name" when creating an Attribute (it has to be a string)'),e=u.name;for(var a in u)r(["name","multiplicity","default","dataName"]).to.include(a,'Invalid property "'+a+'" when creating an Attribute '+'called "'+e+'" (valid properties are "name", "type", '+'"multiplicity", "default" and "dataName")');u.hasOwnProperty("multiplicity")&&(r(u.multiplicity).to.be.a("string",'Invalid property "multiplicity" when creating an Attribute called "'+e+'" (it has to be a string)'),r(["1","0..1","1..*","*"]).to.contain(u.multiplicity,'Invalid property "multiplicity" when creating an Attribute called "'+e+'" (valid values are "1", "0..1", "1..*", "*")'),n=u.multiplicity),u.hasOwnProperty("default")&&(i=u.default);if(u.dataName)if(typeof u.dataName=="string")s=u.dataName;else{r(u.dataName).to.be.an("object",'Invalid property "dataName" when creating an Attribute called "'+e+'" (it has to be a string or an object)'),s={};for(o in u.dataName)r(u.dataName[o]).to.be.a("string",'Invalid property "dataName" for adapter "'+o+'" when '+'creating an Attribute called "'+e+'" (it has to be a '+"string)"),s[o]=u.dataName[o];Object.preventExtensions(s),Object.seal(s),Object.freeze(s)}}else{r(arguments[0]).to.be.a("string",'Invalid argument "name" when creating an Attribute (it has to be a string)'),e=arguments[0],arguments.length>1&&(r(arguments[1]).to.be.a("string",'Invalid argument "multiplicity" when creating an Attribute called "'+e+'" (it has to be a string)'),r(["1","0..1","1..*","*"]).to.contain(arguments[1],'Invalid argument "multiplicity" when creating an Attribtue called "'+e+'" (valid values are "1", "0..1", "1..*", "*")'),n=arguments[1]),arguments.length>2&&(i=arguments[2]);if(arguments.length>3&&arguments[3])if(typeof arguments[3]=="string")s=arguments[3];else{r(arguments[3]).to.be.an("object",'Invalid argument "dataName" when creating an Attribute called "'+e+'" (it has to be a string or an object)'),s={};for(o in arguments[3])r(arguments[3][o]).to.be.a("string",'Invalid argument "dataName" for adapter "'+o+'" when '+'creating an Attribute called "'+e+'" (it has to be a '+"string)"),s[o]=arguments[3][o];Object.preventExtensions(s),Object.seal(s),Object.freeze(s)}}Object.defineProperty(this,"name",{value:e,enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(this,"type",{value:t,enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(this,"multiplicity",{value:n,enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(this,"default",{value:i,enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(this,"dataName",{value:s,enumerable:!0,writable:!1,configurable:!1}),Object.preventExtensions(this),Object.seal(this)}function l(){r(arguments).to.have.length.within(1,4,"Invalid arguments length when resolving an Attribute (it has to be passed from 1 to 4 arguments)");var e=Array.prototype.slice.call(arguments),t=a.types.ObjectAttribute;if(arguments.length===1&&typeof arguments[0]!="string"){var n=i.copy(arguments[0]);e[0]=n,r(n).to.be.an("object","Invalid argument type when resolving an Attribute (it has to be an object)");if(n.type){r(n.type).to.be.a("string",'Invalid argument "type" when resolving an Attribute'+(n.name?" called"+n.name:"")+" (it has to be a string)");try{t=a.types.get(n.type)}catch(o){if(!(o instanceof s.AttributeTypeNotFoundError))throw o;t=a.types.AssociationAttribute,n.entity=n.type}delete n.type}}else if(arguments.length>1){r(arguments[1]).to.be.a("string",'Invalid argument "type" when resolving an Attribute'+(arguments[0]?" called"+arguments[0]:"")+" (it has to be a string)");try{t=a.types.get(arguments[1])}catch(o){if(!(o instanceof s.AttributeTypeNotFoundError))throw o;t=a.types.AssociationAttribute,e.splice(2,0,arguments[1])}e.splice(1,1)}return new(Function.prototype.bind.apply(t,[null].concat(e)))}function c(e){return r(arguments).to.have.length(1,"Invalid arguments length when getting the default value of an Attribute to an Entity instance (it has to be given 1 argument)"),r(e).to.be.an.instanceOf(u.Entity,'Invalid type of argument "entity" when getting the default value of an Attribute to an Entity instance (it has to be an Entity)'),typeof this.default=="function"?this.default.call(e):this.default}function h(e){r(arguments).to.have.length(1,"Invalid argument length when validating an attribute of an entity (it has to be passed 1 argument)"),r(e).to.be.instanceof(u.Entity,'Invalid argument "entity" when validating an attribute of an entity (it has to be an Entity)');var t=null;e.hasOwnProperty(this.name)&&(t=e[this.name]);if((this.multiplicity==="1"||this.multiplicity==="1..*")&&t===null)throw new o("this attribute is required",e.Entity.specification.name,this.name);if(this.multiplicity==="0..1"&&t!==null||this.multiplicity==="1")try{this.validateValue(t)}catch(n){throw n instanceof o?new o(n.validationMessage,e.Entity.specification.name,this.name):n}else if(this.multiplicity==="*"&&t!==null||this.multiplicity==="1..*"){if(!(t instanceof Array))throw new o("this attribute's value should be an Array",e.Entity.specification.name,this.name);var i=!1;for(var s=0;s<t.length;s++)if(t[s]!==null){try{this.validateValue(t[s])}catch(n){throw n instanceof o?new o(n.validationMessage,e.Entity.specification.name,this.name,s):n}i=!0}if(this.multiplicity==="1..*"&&!i)throw new o("this attribute's value should be a non empty Array",e.Entity.specification.name,this.name)}}function p(){throw new Error('Function "validateValue" has to be implemented in the Attribute specialization')}function d(e){r(arguments).to.have.length.below(2,"Invalid arguments length when getting the data name of an Attribute (it has to be passed less than 2 arguments)");if(e){r(e).to.be.a("string",'Invalid argument "adapterName" when getting the data name of an Attribute (it has to be a string)');if(this.dataName&&typeof this.dataName=="object"&&this.dataName.hasOwnProperty(e))return this.dataName[e]}return this.dataName&&typeof this.dataName=="string"?this.dataName:this.name}function v(e){return r(arguments).to.have.length(1,"Invalid arguments length when getting the data value of an Attribute (it has to be passed 1 argument)"),e}function m(e){return r(arguments).to.have.length(1,"Invalid arguments length when parsing the data value of an Attribute (it has to be passed 1 argument)"),e}var r=e("chai").expect,i=e("../../utils/objects"),s=e("../errors"),o=s.ValidationError,u=e("../index"),a=e("./index");n.exports=f,f.resolve=l,f.prototype.getDefaultValue=c,f.prototype.validate=h,f.prototype.validateValue=p,f.prototype.getDataName=d,f.prototype.getDataValue=v,f.prototype.parseDataValue=m}),define("back4app-entity/models/attributes/AttributeDictionary",["require","exports","module","chai","./Attribute"],function(e,t,n){function s(e){r(arguments).to.have.length.below(2,"Invalid arguments length when creating an AttributeDictionary (it has to be passed less than 2 arguments)");if(e){r(typeof e).to.equal("object","Invalid argument type when creating an AttributeDictionary (it has to be an object)");if(e instanceof Array)for(var t=0;t<e.length;t++)o(this,e[t]);else for(var n in e)o(this,e[n],n)}Object.preventExtensions(this),Object.seal(this)}function o(){var e=arguments[0],t=null,n=null;arguments.length===2?t=arguments[1]:(t=arguments[1],n=arguments[2]),r(t).to.be.an("object","Invalid argument type when adding an attribute "+(n?'called "'+n+'" ':"")+"in an AttributeDictionary (it has to be an object)"),n&&(t.name?r(t.name).to.equal(n,'Invalid argument "name" when adding an attribute called "'+t.name+'" in an AttributeDictionary (the name given in '+"argument and the name given in the attribute object should be equal)"):t.name=n),t instanceof i||(t=i.resolve(t)),r(t.constructor).to.not.equal(i,'Invalid attribute "'+t.name+'". Attribute is an abstract '+"class and cannot be directly instantiated and added in an "+"AttributeDictionary"),r(e).to.not.have.ownProperty(t.name,'Duplicated attribute name "'+t.name+'"'),Object.defineProperty(e,t.name,{value:t,enumerable:!0,writable:!1,configurable:!1})}function u(e,t){r(arguments).to.have.length(2,"Invalid arguments length when concatenating an AttributeDictionary (it has to be passed 2 arguments)"),r(e).to.be.instanceof(s,'Invalid argument "attributeDictionary" when concatenating an AttributeDictionary (it has to be an AttributeDictionary)'),r(t).to.be.instanceof(i,'Invalid argument "attribute" when concatenating an AttributeDictionary (it has to be an Attribute)');var n=[];for(var o in e)n.push(e[o]);return n.push(t),new s(n)}var r=e("chai").expect,i=e("./Attribute");n.exports=s,s.concat=u}),define("back4app-entity/models/attributes/types/AssociationAttribute",["require","exports","module","chai","../../../utils/classes","../../../utils/objects","../../index","../../errors","../Attribute"],function(e,t,n){function f(){this.Entity=null;var e=null;Object.defineProperty(this,"Entity",{get:function(){return typeof e=="string"&&(e=o.Entity.getSpecialization(e)),e},set:function(){throw new Error("Entity property of an AssociationAttribute instance cannot be changed")},enumerable:!0,configurable:!1});var t=Array.prototype.slice.call(arguments);r(t).to.have.length.within(1,5,"Invalid arguments length when creating an AssociationAttribute (it has to be passed from 1 to 5 arguments)");if(t.length===1){var n=t[0];r(n).to.be.an("object","Invalid argument type when creating an Attribute (it has to be an object)"),n=s.copy(n),e=n.entity,e?delete n.entity:(r(n).to.have.ownProperty("Entity",'Property "entity" or "Entity" is required when creating an AssociationAttribute'),e=n.Entity,delete n.Entity),t[0]=n}else e=t.splice(1,1)[0];typeof e!="string"&&(r(e).to.be.a("function",'Invalid argument "entity" when creating an AssociationAttribute (it has to be a Class)'),r(i.isGeneral(o.Entity,e)).to.equal(!0,'Invalid argument "entity" when creating an AssociationAttribute (it has to be a subclass of Entity)')),a.apply(this,t)}function l(e){if(!(e instanceof this.Entity))throw new u("this attribute's value should be a \""+this.Entity.specification.name+'"');e.validate()}function c(e){r(arguments).to.have.length(1,"Invalid arguments length when getting the data value of an Attribute (it has to be passed 1 argument)");var t=e;if(e instanceof o.Entity)t={Entity:e.Entity.specification.name,id:e.id};else if(e instanceof Array){t=[];for(var n=0;n<e.length;n++)e[n]instanceof o.Entity?t.push({Entity:e[n].Entity.specification.name,id:e[n].id}):t.push(e[n])}return t}function h(e){function i(e){if(typeof e!="object"||e===null)return e;try{var t=s.copy(e),n=o.Entity.new(t.Entity);return delete t.Entity,n(t)}catch(r){return e}}r(arguments).to.have.length(1,"Invalid arguments length when parsing the data value of an Attribute (it has to be passed 1 argument)");var t=e;if(e instanceof Array){t=[];for(var n=0;n<e.length;n++)t.push(i(e[n]))}else t=i(e);return t}var r=e("chai").expect,i=e("../../../utils/classes"),s=e("../../../utils/objects"),o=e("../../index"),u=e("../../errors").ValidationError,a=e("../Attribute");n.exports=f,i.generalize(a,f),f.typeName="Association",f.prototype.validateValue=l,f.prototype.getDataValue=c,f.prototype.parseDataValue=h}),define("back4app-entity/models/attributes/types/BooleanAttribute",["require","exports","module","../../../utils/classes","../../errors","../Attribute"],function(e,t,n){function o(){s.apply(this,Array.prototype.slice.call(arguments))}function u(e){if(typeof e!="boolean")throw new i("this attribute's value should be a boolean")}var r=e("../../../utils/classes"),i=e("../../errors").ValidationError,s=e("../Attribute");n.exports=o,r.generalize(s,o),o.typeName="Boolean",o.prototype.validateValue=u}),define("back4app-entity/models/attributes/types/DateAttribute",["require","exports","module","chai","../../../utils/classes","../../errors","../Attribute"],function(e,t,n){function u(){o.apply(this,Array.prototype.slice.call(arguments))}function a(e){if(!(e instanceof Date)||isNaN(e.getTime()))throw new s("this attribute's value should be a Date")}function f(e){function i(e){if(typeof e!="string"||e===null)return e;try{var t=new Date(e);return isNaN(t.getTime())?e:t}catch(n){return e}}r(arguments).to.have.length(1,"Invalid arguments length when parsing the data value of an Attribute (it has to be passed 1 argument)");var t=e;if(e instanceof Array){t=[];for(var n=0;n<e.length;n++)t.push(i(e[n]))}else t=i(e);return t}var r=e("chai").expect,i=e("../../../utils/classes"),s=e("../../errors").ValidationError,o=e("../Attribute");n.exports=u,i.generalize(o,u),u.typeName="Date",u.prototype.validateValue=a,u.prototype.parseDataValue=f}),define("back4app-entity/models/attributes/types/NumberAttribute",["require","exports","module","../../../utils/classes","../../errors","../Attribute"],function(e,t,n){function o(){s.apply(this,Array.prototype.slice.call(arguments))}function u(e){if(typeof e!="number"&&!(e instanceof Number))throw new i("this attribute's value should be a number")}var r=e("../../../utils/classes"),i=e("../../errors").ValidationError,s=e("../Attribute");n.exports=o,r.generalize(s,o),o.typeName="Number",o.prototype.validateValue=u}),define("back4app-entity/models/attributes/types/ObjectAttribute",["require","exports","module","../../../utils/classes","../../errors","../Attribute"],function(e,t,n){function o(){s.apply(this,Array.prototype.slice.call(arguments))}function u(e){if(e===null||typeof e!="object")throw new i("this attribute's value should be an object")}var r=e("../../../utils/classes"),i=e("../../errors").ValidationError,s=e("../Attribute");n.exports=o,r.generalize(s,o),o.typeName="Object",o.prototype.validateValue=u}),define("back4app-entity/models/attributes/types/StringAttribute",["require","exports","module","../../../utils/classes","../../errors","../Attribute"],function(e,t,n){function o(){s.apply(this,Array.prototype.slice.call(arguments))}function u(e){if(typeof e!="string"&&!(e instanceof String))throw new i("this attribute's value should be a string")}var r=e("../../../utils/classes"),i=e("../../errors").ValidationError,s=e("../Attribute");n.exports=o,r.generalize(s,o),o.typeName="String",o.prototype.validateValue=u}),define("back4app-entity/models/attributes/types/index",["require","exports","module","chai","../../errors","./AssociationAttribute","./BooleanAttribute","./DateAttribute","./NumberAttribute","./ObjectAttribute","./StringAttribute","../index"],function(e,t,n){function c(e){r(arguments).to.have.length(1,"Invalid arguments length when getting an Attribute type (it has to be passed 1 argument)"),r(e).to.be.a("string",'Invalid argument "type" when getting an Attribute type (it has to be a string');if(n.exports.hasOwnProperty(e))return n.exports[e];if(n.exports.hasOwnProperty(e+"Attribute"))return n.exports[e+"Attribute"];throw new i(e)}var r=e("chai").expect,i=e("../../errors").AttributeTypeNotFoundError,s=e("./AssociationAttribute"),o=e("./BooleanAttribute"),u=e("./DateAttribute"),a=e("./NumberAttribute"),f=e("./ObjectAttribute"),l=e("./StringAttribute");n.exports={},n.exports.AssociationAttribute=s,n.exports.BooleanAttribute=o,n.exports.DateAttribute=u,n.exports.NumberAttribute=a,n.exports.ObjectAttribute=f,n.exports.StringAttribute=l,n.exports.get=null,e("../index").types=n.exports,Object.defineProperty(n.exports,"get",{value:c,enumerable:!1,writable:!1,configurable:!0})}),define("back4app-entity/models/attributes/types",["back4app-entity/models/attributes/types/index"],function(e){return e}),define("back4app-entity/models/attributes/index",["require","exports","module","./Attribute","./AttributeDictionary","./types"],function(e,t,n){var r=e("./Attribute"),i=e("./AttributeDictionary"),s=e("./types");n.exports={},n.exports.Attribute=r,n.exports.AttributeDictionary=i,n.exports.types=s}),define("back4app-entity/models/attributes",["back4app-entity/models/attributes/index"],function(e){return e}),define("back4app-entity/models/methods",["require","exports","module","chai"],function(e,t,n){function i(e){r(arguments).to.have.length.below(2,"Invalid arguments length when creating a new MethodDictionary (it has to be passed less than 2 arguments)");if(e){r(e).to.be.an("object","Invalid argument type when creating a new MethodDictionary (it has to be an object)");for(var t in e)s(this,e[t],t)}Object.preventExtensions(this),Object.seal(this)}function s(e,t,n){r(t).to.be.a("function",'Invalid argument "func" when adding a method called "'+n+'" in a '+"MethodDictionary (it has to be a function)"),Object.defineProperty(e,n,{value:t,enumerable:!0,writable:!1,configurable:!1})}function o(e,t,n){r(arguments).to.have.length(3,"Invalid arguments length when concatenating a MethodDictionary (it has to be passed 3 arguments)"),r(e).to.be.instanceof(i,'Invalid argument "methodDictionary" when concatenating a MethodDictionary (it has to be a MethodDictionary)'),r(t).to.be.a("function",'Invalid argument "func" when concatenating a MethodDictionary (it has to be a function)'),r(n).to.be.a("string",'Invalid argument "name" when concatenating a MethodDictionary (it has to be a string)'),r(e).to.not.have.ownProperty(n,'Duplicated method name "'+n+'"');var s={};for(var o in e)s[o]=e[o];return s[n]=t,new i(s)}var r=e("chai").expect;n.exports={},n.exports.MethodDictionary=i,i.concat=o}),define("back4app-entity/models/EntitySpecification",["require","exports","module","chai","../utils/classes","./index","./attributes","./methods"],function(e,t,n){function a(){function g(){if(e&&e!==s.Entity){e.adapter.loadEntity(e);for(var t in n)y(n[t]);for(var r in a)b(a[r],r)}}function y(t){r(a).to.not.have.ownProperty(t.name,'failed to load entity attribute "'+t.name+'" because '+"there is a method with same name in the current Entity and it cannot "+"be overloaded"),e.General&&(r(e.General.attributes).to.not.have.ownProperty(t.name,'failed to load entity attribute "'+t.name+'" because '+"there is an attribute with same name in a parent of current Entity "+"and it cannot be overriden"),r(e.General.methods).to.not.respondTo(t.name,'failed to load entity attribute "'+t.name+'" because '+"there is a method with same name in a parent of current Entity "+"and it cannot be overriden"));var n=e.specializations;for(var i in n)r(n[i].specification.attributes).to.not.have.ownProperty(t.name,'failed to load entity attribute "'+t.name+'" because '+"there is an attribute with same name in a child of current Entity"),r(n[i].specification.methods).to.not.have.ownProperty(t.name,'failed to load entity attribute "'+t.name+'" because '+"there is a method with same name in a child of current Entity");e.adapter.loadEntityAttribute(e,t)}function b(t,i){r(n).to.not.have.ownProperty(i,'failed to load entity method "'+i+'" because there is an '+"attribute with same name in the current Entity and it cannot be "+"overloaded"),e.General&&r(e.General.attributes).to.not.have.ownProperty(i,'failed to load entity method "'+i+'" because there is an '+"attribute with same name in a parent of current Entity and it "+"cannot be overriden");var s=e.specializations;for(var o in s)r(s[o].specification.attributes).to.not.have.ownProperty(i,'failed to load entity method "'+i+'" because there is an '+"attribute with same name in a child of current Entity");e.prototype[i]=t}function w(){var t=arguments.length===1&&arguments[0]instanceof o.Attribute?arguments[0]:o.Attribute.resolve.apply(null,Array.prototype.slice.call(arguments)),r=o.AttributeDictionary.concat(n,t);e&&y(t),n=r}function E(t,n){var r=u.MethodDictionary.concat(a,t,n);e&&b(t,n),a=r}this.Entity=null,this.name=null,this.attributes=null,this.methods=null,this.isAbstract=null,this.dataName=null,this.addAttribute=w,this.addMethod=E;var e=null;Object.defineProperty(this,"Entity",{get:function(){return e},set:function(t){if(!!e)throw new Error('Once that the property "Entity" of an EntitySpecification instance is assigned, it can not be assigned anymore');r(i.isGeneral(s.Entity,t)).to.equal(!0,'The property "Entity" of an EntitySpecification instance has to be an Entity class'),t.specification&&r(t.specification).to.equal(this,'The property "Specification" of the Entity class should be equal to the current SpecificationEntity instance.'),e=t,g()},enumerable:!0,configurable:!1});var t=null,n=new o.AttributeDictionary;Object.defineProperty(this,"attributes",{get:function(){return n},set:function(){throw new Error("Attributes of an EntitySpecification instance cannot be changed")},enumerable:!0,configurable:!1});var a=new u.MethodDictionary;Object.defineProperty(this,"methods",{get:function(){return a},set:function(){throw new Error("Methods of an EntitySpecification instance cannot be changed")},enumerable:!0,configurable:!1});var f=!1,l,c=null;r(arguments).to.have.length.within(1,4,"Invalid arguments length when creating a new EntitySpecification (it has to be passed from 1 to 4 arguments)");if(arguments.length===1&&typeof arguments[0]!="string"){var h=arguments[0];r(h).to.be.an("object","Invalid argument type when creating a new EntitySpecification (it has to be an object or a string)");for(var p in h)r(["name","attributes","methods","isAbstract","dataName"]).to.include(p,'Invalid property "'+p+'" when creating a new '+'EntitySpecification (valid properties are "name", "attributes", '+'"methods", "isAbstract" and "dataName")');r(h).to.have.ownProperty("name",'Property "name" is required when creating a new EntitySpecification'),r(h.name).to.be.a("string",'Invalid property "name" when creating a new EntitySpecification (it has to be a string)'),t=h.name,h.attributes&&(r(typeof h.attributes).to.equal("object",'Invalid property "attributes" when creating a new EntitySpecification (it has to be an object)'),h.attributes instanceof o.AttributeDictionary?n=h.attributes:n=new o.AttributeDictionary(h.attributes)),h.methods&&(r(h.methods).to.be.an("object",'Invalid property "methods" when creating a new EntitySpecification (it has to be an object)'),h.methods instanceof u.MethodDictionary?a=h.methods:a=new u.MethodDictionary(h.methods)),h.isAbstract&&(r(h.isAbstract).to.be.a("boolean",'Invalid property "isAbstract" when creating a new EntitySpecification (it has to be a boolean)'),f=h.isAbstract);if(h.dataName)if(typeof h.dataName=="string")l=h.dataName;else{r(h.dataName).to.be.an("object",'Invalid property "dataName" when creating a new EntitySpecification (it has to be a string or an object)'),l={};for(c in h.dataName)r(h.dataName[c]).to.be.a("string",'Invalid property "dataName" for adapter "'+c+'" when '+"creating a new EntitySpecification (it has to be a string)"),l[c]=h.dataName[c];Object.preventExtensions(l),Object.seal(l),Object.freeze(l)}}else{r(arguments[0]).to.be.a("string","Invalid argument type when creating a new EntitySpecification (it has to be an object or a string)"),t=arguments[0];if(arguments.length>1&&arguments[1]){var d=arguments[1];r(typeof d).to.equal("object",'Invalid argument "attributes" when creating a new EntitySpecification (it has to be an object)'),d instanceof o.AttributeDictionary?n=d:n=new o.AttributeDictionary(d)}if(arguments.length>2&&arguments[2]){var v=arguments[2];r(v).to.be.an("object",'Invalid argument "methods" when creating a new EntitySpecification (it has to be an object)'),v instanceof u.MethodDictionary?a=v:a=new u.MethodDictionary(v)}if(arguments.length>3&&arguments[3]){var m=arguments[3];r(m).to.be.an("object",'Invalid argument "object" when creating a new EntitySpecification (it has to be an object)'),m.isAbstract&&(r(m.isAbstract).to.be.a("boolean",'Invalid property "isAbstract" when creating a new EntitySpecification (it has to be a boolean)'),f=m.isAbstract);if(m.dataName)if(typeof m.dataName=="string")l=m.dataName;else{r(m.dataName).to.be.an("object",'Invalid property "dataName" when creating a new EntitySpecification (it has to be a string or an object)'),l={};for(c in m.dataName)r(m.dataName[c]).to.be.a("string",'Invalid property "dataName" for adapter "'+c+'" when creating a new EntitySpecification (it has to be a '+"string)"),l[c]=m.dataName[c];Object.preventExtensions(l),Object.seal(l),Object.freeze(l)}}}Object.defineProperty(this,"name",{get:function(){return t},set:function(){throw new Error("Name of an EntitySpecification instance cannot be changed")},enumerable:!0,configurable:!1}),Object.defineProperty(this,"isAbstract",{value:f,enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(this,"dataName",{value:l,enumerable:!0,writable:!1,configurable:!1}),g(),Object.preventExtensions(this),Object.seal(this)}function f(e){r(arguments).to.have.length.below(2,"Invalid arguments length when getting the data name of an EntitySpecification (it has to be passed less than 2 arguments)");if(e){r(e).to.be.a("string",'Invalid argument "adapterName" when getting the data name of an EntitySpecification (it has to be a string)');if(this.dataName&&typeof this.dataName=="object"&&this.dataName.hasOwnProperty(e))return this.dataName[e]}return this.dataName&&typeof this.dataName=="string"?this.dataName:this.name}var r=e("chai").expect,i=e("../utils/classes"),s=e("./index"),o=e("./attributes"),u=e("./methods");n.exports=a,a.prototype.getDataName=f}),function(){function l(e,t,n){var r=t&&n||0,i=0;t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){i<16&&(t[r+i++]=a[e])});while(i<16)t[r+i++]=0;return t}function c(e,t){var n=t||0,r=u;return r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+"-"+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]+r[e[n++]]}function g(e,t,n){var r=t&&n||0,i=t||[];e=e||{};var s=e.clockseq!=null?e.clockseq:d,o=e.msecs!=null?e.msecs:(new Date).getTime(),u=e.nsecs!=null?e.nsecs:m+1,a=o-v+(u-m)/1e4;a<0&&e.clockseq==null&&(s=s+1&16383),(a<0||o>v)&&e.nsecs==null&&(u=0);if(u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");v=o,m=u,d=s,o+=122192928e5;var f=((o&268435455)*1e4+u)%4294967296;i[r++]=f>>>24&255,i[r++]=f>>>16&255,i[r++]=f>>>8&255,i[r++]=f&255;var l=o/4294967296*1e4&268435455;i[r++]=l>>>8&255,i[r++]=l&255,i[r++]=l>>>24&15|16,i[r++]=l>>>16&255,i[r++]=s>>>8|128,i[r++]=s&255;var h=e.node||p;for(var g=0;g<6;g++)i[r+g]=h[g];return t?t:c(i)}function y(e,n,r){var i=n&&r||0;typeof e=="string"&&(n=e=="binary"?new o(16):null,e=null),e=e||{};var s=e.random||(e.rng||t)();s[6]=s[6]&15|64,s[8]=s[8]&63|128;if(n)for(var u=0;u<16;u++)n[i+u]=s[u];return n||c(s)}var e=this,t;if(typeof e.require=="function")try{var n=e.require("crypto").randomBytes;t=n&&function(){return n(16)}}catch(r){}if(!t&&e.crypto&&crypto.getRandomValues){var i=new Uint8Array(16);t=function(){return crypto.getRandomValues(i),i}}if(!t){var s=new Array(16);t=function(){for(var e=0,t;e<16;e++)(e&3)===0&&(t=Math.random()*4294967296),s[e]=t>>>((e&3)<<3)&255;return s}}var o=typeof e.Buffer=="function"?e.Buffer:Array,u=[],a={};for(var f=0;f<256;f++)u[f]=(f+256).toString(16).substr(1),a[u[f]]=f;var h=t(),p=[h[0]|1,h[1],h[2],h[3],h[4],h[5]],d=(h[6]<<8|h[7])&16383,v=0,m=0,b=y;b.v1=g,b.v4=y,b.parse=l,b.unparse=c,b.BufferClass=o;if(typeof module!="undefined"&&module.exports)module.exports=b;else if(typeof define=="function"&&define.amd)define("node-uuid",[],function(){return b});else{var w=e.uuid;b.noConflict=function(){return e.uuid=w,b},e.uuid=b}}.call(this),define("back4app-entity/models/Entity",["require","exports","module","chai","bluebird","../settings","../utils/classes","../utils/objects","../adapters/Adapter","./EntitySpecification","./attributes/AttributeDictionary","./attributes/types/AssociationAttribute","./methods","./errors","node-uuid","./index"],function(e,t,n){"use strict";function g(e,t){function p(e,t){s[e]=!1,Object.defineProperty(n,e,{get:function(){if(a&&!r.hasOwnProperty(e)&&!s[e]&&e!=="id")throw new v.NotFetchedError(n.Entity.specification.name,e,null);return t},set:function(n){s[e]=!0,t=n},enumerable:!0,configurable:e==="id"})}function d(e){i(arguments).to.have.length.below(2,"Invalid arguments length when checking if an Entity attribute is dirty (it has to be passed less than 2 arguments)");var t=this.Entity.attributes;if(e){i(e).to.be.a("string",'Invalid argument "attribute" when checking if an Entity attribute is dirty (it has to be a string)'),i(t).to.have.ownProperty(e,'Invalid argument "attribute" when checking an Entity attribute is dirty (this attribute does not exist in the Entity)');var n={};n[e]=t[e],t=n}if(this.isNew)return!0;for(var o in t)if(a){if(s[o])if(!r.hasOwnProperty(o)||r[o]!==this[o])return!0}else if(!r.hasOwnProperty(o)||r[o]!==this[o])return!0;return!1}function m(e){i(arguments).to.have.length.below(2,"Invalid arguments length when cleaning an Entity attribute (it has to be passed less than 2 arguments)");var t=this.Entity.attributes;if(e){i(e).to.be.a("string",'Invalid argument "attribute" when cleaning an Entity attribute (it has to be a string)'),i(t).to.have.ownProperty(e,'Invalid argument "attribute" when cleaning an Entity attribute (this attribute does not exist in the Entity)');var n={};n[e]=t[e],t=n}for(var o in t)r[o]=this[o],s[o]=!1}var n=this;this.adapterName=null,this.adapter=null;if(!this.hasOwnProperty("Entity")||!this.Entity)this.Entity=null;this.General=null,this.isNew=null,this.id=null;var r={},s={};this.isDirty=d,this.clean=m,(!this.hasOwnProperty("Entity")||!this.Entity)&&Object.defineProperty(this,"Entity",{value:g,enumerable:!1,writable:!1,configurable:!1}),Object.defineProperty(this,"General",{get:function(){return this.Entity.General},set:function(){throw new Error("General property of an Entity instance cannot be changed")},enumerable:!1,configurable:!1}),Object.defineProperty(this,"adapterName",{value:this.Entity.adapterName,writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(this,"adapter",{value:this.Entity.adapter,writable:!1,enumerable:!1,configurable:!1});var o=!0;Object.defineProperty(this,"isNew",{get:function(){return o},set:function(e){i(e).to.be.a("boolean","Invalid value when setting isNew value (it has to be a boolean)"),o=e},enumerable:!1,configurable:!1}),Object.defineProperty(this,"isDirty",{value:d,writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(this,"clean",{value:m,writable:!1,enumerable:!1,configurable:!1}),i(this).to.be.an("object","The Entity's constructor can be only invoked from specialized classes' constructors"),i(this.constructor).to.be.a("function","The Entity's constructor can be only invoked from specialized classes' constructors"),i(this.constructor).to.not.equal(g,"The Entity is an abstract class and cannot be directly initialized"),i(this).to.be.instanceof(g,"The Entity's constructor can be only invoked from specialized classes' constructors"),i(arguments).to.have.length.below(3,'Invalid arguments length when creating "'+this.Entity.specification.name+'" (it has to be passed less than 3 arguments)');var u=!1,a=!1;t&&(i(t).to.be.an("object",'Invalid argument "options" when creating a new "'+this.Entity.specification.name+'" (it has to be an object)'),t.hasOwnProperty("isNew")&&(i(t.isNew).to.be.a("boolean",'Invalid argument "options.isNew" when creating a new "'+this.Entity.specification.name+'" (it has to be a boolean)'),this.isNew=t.isNew,t.isNew&&(u=!0)),t.hasOwnProperty("clean")&&(i(t.clean).to.be.a("boolean",'Invalid argument "options.clean" when creating a new "'+this.Entity.specification.name+'" (it has to be a boolean)'),t.clean&&(a=!0))),e&&(i(e).to.be.an("object",'Invalid argument "attributeValues" when creating a new "'+this.Entity.specification.name+'" (it has to be an object)'),!u&&e.hasOwnProperty("id")&&(this.isNew=!1));var f=this.Entity.attributes;for(var l in e)i(f,'Invalid property "'+l+'" when creating a new "'+this.Entity.specification.name+'" (it does not exist)').to.include.keys(l);for(l in f){var c=null;e&&e.hasOwnProperty(l)&&(c=e[l],this.isNew||(r[l]=c)),p(l,c)}for(l in f)(!a||l==="id")&&this[l]===null&&f[l].default!==null&&(this[l]=f[l].getDefaultValue(this));var h="^[a-fA-F0-9]{8}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{4}-[a-fA-F0-9]{12}$";i((new RegExp(h)).test(this.id)).to.equal(!0,'Invalid property "id" when creating a new "'+this.Entity.specification.name+'" (it has to be a valid uuid)'),Object.defineProperty(this,"id",{value:this.id,enumerable:!0,writable:!1,configurable:!1}),Object.preventExtensions(this)}function x(){if(!S)try{i(u).to.have.ownProperty("ADAPTERS"),i(u.ADAPTERS).to.have.ownProperty(this.adapterName);var e=u.ADAPTERS[this.adapterName];i(e).to.be.an.instanceOf(l),S=e}catch(t){throw t instanceof s?new v.AdapterNotFoundError(this.adapterName,t):t}return S}function T(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n],T(e[n].directSpecializations,t))}function A(e){return function(t){return i(arguments).to.have.length(1,"Invalid arguments length when getting an Entity (it has to be passed 1 argument)"),i(t).to.be.an("object","Invalid argument when getting an Entity (it has to be an object)"),o.try(function(){var n=e.adapter;return n.getObject(e,t)})}}function O(e){return function(t){return i(arguments).to.have.length(1,"Invalid arguments length when finding an Entity (it has to be passed 1 argument)"),i(t).to.be.an("object","Invalid argument when finding an Entity (it has to be an object)"),o.try(function(){var n=e.adapter;return n.findObjects(e,t)})}}function M(e){i(arguments).to.have.length.below(2,"Invalid arguments length when validating an Entity (it has to be passed less than 2 arguments)");var t=this.Entity.attributes;if(e){i(e).to.be.a("string",'Invalid argument "attribute" when validating an Entity (it has to be a string)'),i(t).to.have.ownProperty(e,'Invalid argument "attribute" when validating an Entity (this attribute does not exist in the Entity)');var n={};n[e]=t[e],t=n}for(e in t)this.isDirty(e)&&t[e].validate(this)}function _(e){try{this.validate(e)}catch(t){if(t instanceof v.ValidationError)return!1;throw t}return!0}function D(e){var t=this;return i(arguments).to.have.length.below(2,"Invalid arguments length when saving an Entity (it has to be passed less than 2 arguments)"),new o(function(n,r){var s=t.isNew,u=!1,a=!1;e&&(i(e).to.be.an("object",'Invalid argument "options" when saving an Entity (it has to be an object)'),e.hasOwnProperty("forceCreate")&&(i(e.forceCreate).to.be.a("boolean",'Invalid argument "options.forceCreate" when saving an Entity (it has to be a boolean)'),e.forceCreate&&(u=!0)),e.hasOwnProperty("forceUpdate")&&(i(e.forceUpdate).to.be.a("boolean",'Invalid argument "options.forceUpdate" when saving an Entity (it has to be a boolean)'),e.forceUpdate&&(a=!0)),u&&i(u).to.not.equal(a,"It is not possible to force create and update at same time when saving an Entity"),u?s=!0:a&&(s=!1));if(s||t.isDirty()){t.validate();var f=[],l=t.Entity.attributes;for(var c in l)l[c]instanceof p&&t.hasOwnProperty(c)&&t[c]instanceof g&&f.push(t[c].save());var h=null;s?h=t.adapter.insertObject(t):h=t.adapter.updateObject(t),i(h).to.not.equal(null,'Functions "insertObject" and "updateObject" of an Adapter specialization should return a Promise'),i(typeof h).to.equal("object",'Functions "insertObject" and "updateObject" of an Adapter specialization should return a Promise'),i(h).to.respondTo("then",'Functions "insertObject" and "updateObject" of an Adapter specialization should return a Promise'),i(h).to.respondTo("catch",'Functions "insertObject" and "updateObject" of an Adapter specialization should return a Promise'),h.then(function(){t.isNew=!1,t.clean()}),f.push(h),o.all(f).then(function(){n()}).catch(r)}else n()})}function P(){var e=this;return i(arguments).to.have.length(0,'Invalid arguments length when deleting a "'+this.Entity.specification.name+'" instance (it has to be passed 0 arguments)'),new o(function(t,n){var r=e.adapter.deleteObject(e);i(r).to.respondTo("then",'Function "delete" of an Adapter specialization should return a Promise'),i(r).to.respondTo("catch",'Function "delete" of an Adapter specialization should return a Promise'),r.then(t).catch(n)})}var r=e("chai"),i=r.expect,s=r.AssertionError,o=e("bluebird"),u=e("../settings"),a=e("../utils/classes"),f=e("../utils/objects"),l=e("../adapters/Adapter"),c=e("./EntitySpecification"),h=e("./attributes/AttributeDictionary"),p=e("./attributes/types/AssociationAttribute"),d=e("./methods").MethodDictionary,v=e("./errors"),m=e("node-uuid");n.exports=g,e("./index").Entity=g,g.adapterName=null,g.adapter=null,g.General=null,g.specification=null,g.dataName=null,g.attributes=null,g.methods=null,g.directSpecializations=null,g.specializations=null,g.specify=null,g.getSpecialization=null,g.new=null,g.create=null,g.get=null,g.find=null,g.prototype.validate=M,g.prototype.isValid=_,g.prototype.delete=P,g.prototype.save=D,Object.defineProperty(g,"adapterName",{value:"default",writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(g,"adapter",{get:x,set:function(){throw new Error("Adapter property of an Entity class cannot be changed")},enumerable:!0,configurable:!1}),Object.defineProperty(g,"General",{value:null,enumerable:!0,writable:!1,configurable:!1});var y=new h({id:{type:"String","default":m.v4}}),b=new c("Entity",y,null,{isAbstract:!0});Object.defineProperty(g,"specification",{value:b,enumerable:!0,writable:!1,configurable:!1}),b.Entity=g,Object.defineProperty(g,"dataName",{value:g.specification.getDataName(g.adapterName),enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(g,"attributes",{value:y,enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(g,"methods",{value:{},enumerable:!0,writable:!1,configurable:!1});var w={};Object.defineProperty(g,"directSpecializations",{get:function(){var e=f.copy(w);return Object.preventExtensions(e),Object.seal(e),Object.freeze(e),e},set:function(){throw new Error("Specializations of an Entity cannot be changed")},enumerable:!0,configurable:!1});var E={};Object.defineProperty(g,"specializations",{get:function(){var e=f.copy(E);return Object.preventExtensions(e),Object.seal(e),Object.freeze(e),e},set:function(){throw new Error("Specializations of an Entity cannot be changed")},enumerable:!0,configurable:!1});var S=null,N=function(e,t){return function(){i(arguments).to.have.length.within(1,4,"Invalid arguments length when specifying an Entity (it has to be passed from 1 to 4 arguments)");var n=function(){(!this.hasOwnProperty("Entity")||!this.Entity)&&Object.defineProperty(this,"Entity",{value:n,enumerable:!1,writable:!1,configurable:!1}),n.specification.isAbstract&&(i(this).to.be.an("object",'The "'+n.specification.name+"\"'s constructor "+"can be only invoked from specialized classes' constructors"),i(this.constructor).to.be.a("function",'The "'+n.specification.name+"\"'s constructor "+"can be only invoked from specialized classes' constructors"),i(this.constructor).to.not.equal(n,'The "'+n.specification.name+'" is an abstract '+"class and cannot be directly initialized"),i(this).to.be.instanceof(n,'The "'+n.specification.name+"\"'s constructor "+"can be only invoked from specialized classes' constructors")),e.apply(this,Array.prototype.slice.call(arguments))};a.generalize(e,n),Object.defineProperty(n,"General",{value:e,enumerable:!0,writable:!1,configurable:!1});var r=null;if(arguments.length===1&&typeof arguments[0]!="string"){var s=arguments[0];i(s).to.be.an("object","Invalid argument type when specifying an Entity (it has to be an object or a string)"),s instanceof c?r=s:r=new c(s)}else{var o=arguments[0];i(o).to.be.a("string",'Invalid argument "name" when specifying an Entity (it has to be a string)');var u=null,l=null,p=null;arguments.length>1&&arguments[1]&&(u=arguments[1],i(typeof u).to.equal("object",'Invalid property "attributes" when specifying an Entity (it has to be an object)')),arguments.length>2&&arguments[2]&&(l=arguments[2],i(l).to.be.an("object",'Invalid property "methods" when specifying an Entity (it has to be an object)')),arguments.length>3&&arguments[3]&&(p=arguments[3],i(p).to.be.an("object",'Invalid property "options" when specifying an Entity (it has to be an object)')),r=new c(o,u,l,p)}r.isAbstract&&i(e.specification.isAbstract).to.equal(!0,'It was not possible to specify a new Entity called "'+r.name+'" because an abstract Entity '+"cannot be specified by a concrete one"),Object.defineProperty(n,"specification",{value:r,enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(n,"dataName",{value:n.specification.getDataName(n.adapterName),enumerable:!0,writable:!1,configurable:!1}),Object.defineProperty(n,"attributes",{get:function(){var e={},t=[],r=n;while(r&&t.indexOf(r)===-1){for(var i in r.specification.attributes)e.hasOwnProperty(i)||(e[i]=r.specification.attributes[i]);t.push(r),r=r.General}return new h(e)},set:function(){throw new Error("Attributes of an Entity cannot be changed")},enumerable:!0,configurable:!1}),Object.defineProperty(n,"methods",{get:function(){var e={},t=[],r=n;while(r&&t.indexOf(r)===-1){for(var i in r.specification.methods)e.hasOwnProperty(i)||(e[i]=r.specification.methods[i]);t.push(r),r=r.General}return new d(e)},set:function(){throw new Error("Methods of an Entity cannot be changed")},enumerable:!0,configurable:!1});var v={};return Object.defineProperty(n,"directSpecializations",{get:function(){var e=f.copy(v);return Object.preventExtensions(e),Object.seal(e),Object.freeze(e),e},set:function(){throw new Error("Specializations of an Entity cannot be changed")},enumerable:!0,configurable:!1}),Object.defineProperty(n,"specializations",{get:function(){var e={};return T(v,e),Object.preventExtensions(e),Object.seal(e),Object.freeze(e),e},set:function(){throw new Error("Specializations of an Entity cannot be changed")},enumerable:!0,configurable:!1}),n.specify=N(n,v),n.getSpecialization=C(n),n.new=k(n),n.create=L(n),n.get=A(n),n.find=O(n),r.Entity?i(r.Entity).to.equal(n,'The property "Entity" of the EntitySpecification instance should be equal to the Entity that is being specified.'):r.Entity=n,i(E).to.not.have.ownProperty(r.name,'It was not possible to specify a new Entity called "'+r.name+'" because duplicates are not allowed'),E[r.name]=n,t[r.name]=n,n}};g.specify=N(g,w);var C=function(e){return function(t){i(arguments).to.have.length(1,"Invalid arguments length when getting an Entity specialization (it has to be passed 1 argument)"),i(t).to.be.a("string","Invalid argument when creating a new Entity function (it has to be a string");var n=e.specializations;try{i(n).to.have.ownProperty(t)}catch(r){throw new v.EntityNotFoundError(t,r)}return n[t]}};g.getSpecialization=C(g);var k=function(e){return function(t){return i(arguments).to.have.length.below(2,"Invalid arguments length when creating a new Entity function (it has to be passed less than 2 arguments)"),function(n){i(arguments).to.have.length.below(2,"Invalid arguments length when creating a new Entity (it has not to be passed less than 2 arguments)");var r=e;return t&&(r=g.getSpecialization(t)),new r(n)}}};g.new=k(g);var L=function(e){return function(t){return i(arguments).to.have.length.below(2,'Invalid arguments length when creating a new "'+e.specification.name+'" instance (it has to be passed less than 2 arguments)'),new o(function(n,r){var i=new e(t);i.save({forceCreate:!0}).then(function(){n(i)}).catch(r)})}};g.create=L(g),g.get=A(g),g.find=O(g)}),define("back4app-entity/models/index",["require","exports","module","./Entity","./EntitySpecification","./attributes","./methods","./errors"],function(e,t,n){var r=e("./Entity"),i=e("./EntitySpecification"),s=e("./attributes"),o=e("./methods"),u=e("./errors");n.exports={},n.exports.Entity=r,n.exports.EntitySpecification=i,n.exports.attributes=s,n.exports.methods=o,n.exports.errors=u}),define("back4app-entity/models",["back4app-entity/models/index"],function(e){return e}),define("back4app-entity/adapters/index",["require","exports","module","./Adapter"],function(e,t,n){"use strict";var r=e("./Adapter");n.exports={},n.exports.Adapter=r}),define("back4app-entity/adapters",["back4app-entity/adapters/index"],function(e){return e}),define("back4app-entity/index",["require","exports","module","./utils","./settings","./models","./adapters"],function(e,t,n){var r=e("./utils"),i=e("./settings"),s=e("./models"),o=e("./adapters");n.exports={},n.exports.utils=r,n.exports.settings=i,n.exports.models=s,n.exports.adapters=o}),define("back4app-entity",["back4app-entity/index"],function(e){return e});